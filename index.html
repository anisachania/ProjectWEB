<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>MoodyCake ‚Äî Cake Shop</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      /* ------------------------- CSS LAMA (tetap) ------------------------- */
      :root {
        --pink-1: #ffeef8;
        --pink-2: #ffb6d5;
        --pink-3: #ff6fa8;
        --accent: #6b2b4a;
        --muted: #6b5b6b;
        --card-shadow: 0 8px 30px rgba(107, 43, 74, 0.12);
        --glass: rgba(255, 255, 255, 0.6);
      }
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        font-family: "Inter", system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial;
        background: linear-gradient(180deg, var(--pink-1), #fff 40%);
        color: var(--accent);
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        line-height: 1.5;
        overflow-x: hidden;
      }
      header {
        padding: 28px 24px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: relative;
      }
      .brand {
        display: flex;
        align-items: center;
        gap: 16px;
      }
      .logo {
        width: 64px;
        height: 64px;
        border-radius: 12px;
        background: white;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--card-shadow);
        flex-shrink: 0;
        transition: all 0.3s;
        overflow: hidden;
      }
      .logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        padding: 4px;
      }
      .logo:hover {
        transform: rotate(5deg) scale(1.05);
      }
      .brand-name {
        font-family: "Playfair Display";
        font-size: 24px;
        font-weight: 700;
        background: linear-gradient(135deg, var(--pink-3), var(--accent));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        letter-spacing: 1px;
        text-shadow: 0 2px 10px rgba(255, 111, 168, 0.2);
      }
      .brand-tagline {
        font-size: 11px;
        color: var(--pink-3);
        font-weight: 600;
        letter-spacing: 2px;
        text-transform: uppercase;
      }
      nav {
        display: flex;
        gap: 12px;
        align-items: center;
      }
      nav a {
        padding: 8px 12px;
        border-radius: 999px;
        text-decoration: none;
        color: var(--muted);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      nav a:hover {
        background: var(--pink-1);
      }

      .cart-btn {
        position: relative;
        background: var(--pink-3);
        color: white;
        border: none;
        padding: 10px 16px;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 600;
        box-shadow: var(--card-shadow);
        display: flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
      }
      .cart-btn:hover {
        transform: scale(1.05);
      }
      .cart-badge {
        background: var(--accent);
        color: white;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        font-weight: 700;
      }

      /* Floating Cake Character */
      .cake-character {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 100px;
        height: 100px;
        z-index: 999;
        animation: float 3s ease-in-out infinite;
        cursor: pointer;
        transition: transform 0.3s;
      }
      .cake-character:hover {
        transform: scale(1.1) rotate(5deg);
      }
      @keyframes float {
        0%,
        100% {
          transform: translateY(0px);
        }
        50% {
          transform: translateY(-15px);
        }
      }
      .cake-character svg {
        filter: drop-shadow(0 4px 12px rgba(107, 43, 74, 0.3));
      }

      .hero {
        display: grid;
        grid-template-columns: 1fr 520px;
        gap: 24px;
        padding: 24px;
        align-items: center;
        max-width: 1100px;
        margin: 0 auto;
      }
      .hero-left {
        padding: 28px;
        background: var(--glass);
        border-radius: 18px;
        box-shadow: var(--card-shadow);
      }
      .hero h1 {
        font-family: "Playfair Display";
        font-size: 44px;
        margin: 0 0 8px;
      }
      .hero p.lead {
        margin: 0 0 16px;
        color: var(--muted);
      }
      .hero .btns {
        display: flex;
        gap: 12px;
      }
      .btn {
        padding: 12px 18px;
        border-radius: 12px;
        border: 0;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
      }
      .btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--card-shadow);
      }
      .btn-pink {
        background: var(--pink-3);
        color: white;
      }
      .btn-outline {
        background: transparent;
        border: 2px solid var(--pink-2);
        color: var(--accent);
      }

      .card-gallery {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 12px;
      }
      .card {
        background: white;
        border-radius: 14px;
        padding: 12px;
        box-shadow: var(--card-shadow);
        display: flex;
        gap: 12px;
        align-items: center;
        cursor: pointer;
        transition: all 0.3s;
      }
      .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 35px rgba(107, 43, 74, 0.15);
      }
      .card img {
        width: 110px;
        height: 90px;
        object-fit: cover;
        border-radius: 10px;
      }
      .price {
        font-weight: 800;
        color: var(--pink-3);
      }

      /* Menu Tabs */
      .menu-tabs {
        display: flex;
        gap: 12px;
        margin: 20px 0;
        flex-wrap: wrap;
      }
      .tab-btn {
        padding: 10px 20px;
        border-radius: 999px;
        border: 2px solid var(--pink-2);
        background: white;
        color: var(--accent);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      .tab-btn:hover {
        transform: scale(1.05);
      }
      .tab-btn.active {
        background: var(--pink-3);
        color: white;
        border-color: var(--pink-3);
      }

      .gallery {
        max-width: 1100px;
        margin: 28px auto;
        padding: 24px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
        gap: 18px;
      }
      .product {
        background: white;
        border-radius: 14px;
        padding: 12px;
        box-shadow: var(--card-shadow);
        overflow: hidden;
        transition: transform 0.3s;
        cursor: pointer;
      }
      .product:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(107, 43, 74, 0.18);
      }
      .product img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 10px;
      }
      .product .meta {
        padding: 10px;
      }
      .product h3 {
        margin: 0 0 6px;
        font-size: 18px;
      }
      .product p {
        margin: 0 0 9px;
        color: var(--muted);
        font-size: 14px;
      }
      .product .price {
        font-weight: 800;
      }
      .product .actions {
        display: flex;
        gap: 8px;
      }
      .product .badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 700;
        margin-bottom: 8px;
      }
      .badge-featured {
        background: #ffd700;
        color: #6b2b4a;
      }
      .badge-new {
        background: #4ecdc4;
        color: white;
      }
      .badge-popular {
        background: #ff6b6b;
        color: white;
      }

      /* Modal (umum) */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 1200;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }
      .modal.active {
        display: flex;
      }
      .modal-content {
        background: white;
        border-radius: 18px;
        max-width: 640px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        animation: slideUp 0.28s cubic-bezier(0.2, 0.8, 0.2, 1);
      }
      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
      .modal-header {
        padding: 18px;
        border-bottom: 1px solid #f6f3f6;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .modal-body {
        padding: 18px;
      }
      .close-btn {
        background: transparent;
        border: none;
        font-size: 28px;
        cursor: pointer;
        color: var(--muted);
        line-height: 1;
        transition: all 0.3s;
      }
      .close-btn:hover {
        color: var(--pink-3);
        transform: rotate(90deg);
      }

      .quantity-control {
        display: flex;
        align-items: center;
        gap: 12px;
        margin: 16px 0;
      }
      .qty-btn {
        width: 36px;
        height: 36px;
        border-radius: 8px;
        border: 2px solid var(--pink-2);
        background: white;
        cursor: pointer;
        font-weight: 700;
        color: var(--accent);
        transition: all 0.3s;
      }
      .qty-btn:hover {
        background: var(--pink-1);
        transform: scale(1.1);
      }
      .qty-display {
        font-size: 18px;
        font-weight: 700;
        min-width: 40px;
        text-align: center;
      }

      /* Cart Page */
      .cart-page {
        display: none;
        max-width: 900px;
        margin: 40px auto;
        padding: 24px;
      }
      .cart-page.active {
        display: block;
      }
      .cart-item {
        background: white;
        border-radius: 14px;
        padding: 16px;
        margin-bottom: 12px;
        display: flex;
        gap: 16px;
        align-items: center;
        box-shadow: var(--card-shadow);
      }
      .cart-item img {
        width: 100px;
        height: 80px;
        object-fit: cover;
        border-radius: 10px;
      }
      .cart-item-info {
        flex: 1;
      }
      .cart-item-actions {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .remove-btn {
        background: #ff4444;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
      }
      .remove-btn:hover {
        background: #cc0000;
        transform: scale(1.05);
      }
      .cart-summary {
        background: var(--glass);
        border-radius: 14px;
        padding: 20px;
        margin-top: 20px;
        box-shadow: var(--card-shadow);
      }
      .empty-cart {
        text-align: center;
        padding: 60px 20px;
        color: var(--muted);
      }

      /* Map & contact */
      .map-section {
        max-width: 1100px;
        margin: 40px auto;
        padding: 24px;
        background: var(--glass);
        border-radius: 18px;
        box-shadow: var(--card-shadow);
      }
      .map-container {
        width: 100%;
        height: 400px;
        border-radius: 14px;
        overflow: hidden;
        margin-top: 16px;
        box-shadow: var(--card-shadow);
      }
      .map-container iframe {
        width: 100%;
        height: 100%;
        border: none;
      }
      .contact-info {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 24px;
      }
      .contact-card {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: var(--card-shadow);
        display: flex;
        align-items: center;
        gap: 16px;
        transition: all 0.3s;
      }
      .contact-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(107, 43, 74, 0.18);
      }
      .contact-icon {
        font-size: 32px;
        flex-shrink: 0;
        animation: bounce 2s ease-in-out infinite;
      }
      @keyframes bounce {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }
      .contact-details h4 {
        margin: 0 0 4px;
        font-size: 14px;
        color: var(--muted);
        font-weight: 600;
      }
      .contact-details p {
        margin: 0;
        font-weight: 600;
        color: var(--accent);
      }

      /* Testimonial */
      .testimonial-section {
        max-width: 1100px;
        margin: 40px auto;
        padding: 24px;
      }
      .testimonial-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 24px;
      }
      .testimonial-card {
        background: rgb(255, 188, 216);
        padding: 24px;
        border-radius: 14px;
        box-shadow: var(--card-shadow);
        transition: all 0.3s;
        position: relative;
        overflow: hidden;
      }
      .testimonial-card::before {
        content: "‚ùù";
        position: absolute;
        top: -10px;
        left: 10px;
        font-size: 80px;
        color: var(--pink-2);
        opacity: 0.3;
        font-family: "Playfair Display";
      }
      .testimonial-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 15px 50px rgba(21, 8, 14, 0.2);
      }

      /* stats */
      .stats-section {
        max-width: 1100px;
        margin: 40px auto;
        padding: 24px;
        background: linear-gradient(135deg, var(--pink-3), var(--accent));
        border-radius: 18px;
        box-shadow: var(--card-shadow);
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 24px;
      }
      .stat-item {
        text-align: center;
        padding: 20px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 12px;
        backdrop-filter: blur(10px);
        transition: all 0.3s;
      }
      .stat-item:hover {
        background: rgba(255, 255, 255, 0.25);
        transform: scale(1.05);
      }
      .stat-number {
        font-size: 42px;
        font-weight: 700;
        color: white;
        font-family: "Playfair Display";
        margin-bottom: 8px;
      }
      .stat-label {
        color: white;
        font-size: 14px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      footer {
        padding: 28px;
        text-align: center;
        color: var(--muted);
      }

      /* Mobile Menu */
      .mobile-menu-btn {
        display: none;
        background: transparent;
        border: none;
        font-size: 28px;
        cursor: pointer;
        color: var(--accent);
      }
      .mobile-nav {
        display: none;
        position: fixed;
        top: 0;
        right: -100%;
        width: 280px;
        height: 100vh;
        background: white;
        box-shadow: -5px 0 20px rgba(0, 0, 0, 0.1);
        padding: 80px 20px 20px;
        transition: right 0.3s;
        z-index: 1001;
      }
      .mobile-nav.active {
        right: 0;
      }
      .mobile-nav a,
      .mobile-nav button {
        display: block;
        width: 100%;
        padding: 16px;
        margin-bottom: 8px;
        text-align: left;
        border-radius: 12px;
        border: none;
        background: white;
        color: var(--accent);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
      }
      .mobile-nav a:hover,
      .mobile-nav button:hover {
        background: var(--pink-1);
      }
      .mobile-nav .cart-btn {
        background: var(--pink-3);
        color: white;
        justify-content: center;
      }
      .close-mobile-menu {
        position: absolute;
        top: 20px;
        right: 20px;
        background: transparent;
        border: none;
        font-size: 32px;
        cursor: pointer;
        color: var(--muted);
      }
      .mobile-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1000;
      }
      .mobile-overlay.active {
        display: block;
      }

      @media (max-width: 900px) {
        .hero {
          grid-template-columns: 1fr;
          gap: 16px;
        }
        .hero-left,
        .hero-right {
          width: 100%;
        }
        .hero h1 {
          font-size: 32px;
        }
        .hero-left {
          padding: 20px;
        }
        nav {
          display: none;
        }
        .mobile-menu-btn {
          display: block;
        }
        .mobile-nav {
          display: block;
        }
        .cake-character {
          width: 70px;
          height: 70px;
          bottom: 20px;
          right: 20px;
        }
        .card-gallery {
          grid-template-columns: 1fr;
        }
        .gallery {
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
          gap: 12px;
        }
        .product img {
          height: 140px;
        }
        .brand-name {
          font-size: 20px;
        }
        .brand-tagline {
          font-size: 9px;
        }
        .cart-item {
          flex-direction: column;
          align-items: flex-start;
        }
        .cart-item img {
          width: 100%;
          height: 150px;
        }
        .cart-item-actions {
          width: 100%;
          justify-content: space-between;
        }
        .map-container {
          height: 300px;
        }
        .contact-info {
          grid-template-columns: 1fr;
        }
        .testimonial-grid {
          grid-template-columns: 1fr;
        }
        .stats-grid {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 600px) {
        header {
          padding: 20px 16px;
        }
        .hero {
          padding: 16px;
        }
        .hero h1 {
          font-size: 28px;
        }
        .hero .btns {
          flex-direction: column;
        }
        .btn {
          width: 100%;
        }
        .logo {
          width: 56px;
          height: 56px;
        }
        .logo img {
          padding: 2px;
        }
        .brand-name {
          font-size: 18px;
        }
        .menu-tabs {
          gap: 8px;
        }
        .tab-btn {
          padding: 8px 16px;
          font-size: 14px;
        }
        section {
          padding: 16px !important;
        }
        .gallery {
          padding: 16px;
        }
        .modal-content {
          margin: 10px;
          max-width: calc(100% - 20px);
        }
        .cart-btn {
          padding: 8px 12px;
          font-size: 14px;
        }
        .map-section {
          padding: 16px;
        }
        .map-container {
          height: 250px;
        }
        .contact-card {
          flex-direction: column;
          text-align: center;
        }
        .stats-grid {
          grid-template-columns: 1fr;
        }
        .stat-number {
          font-size: 32px;
        }
      }

      .notify-icon {
        width: 48px;
        height: 48px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 12px;
        background: linear-gradient(135deg, var(--pink-3), var(--accent));
        color: white;
        font-size: 22px;
      }
      .notify-header {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 18px;
        border-bottom: 1px solid #ffecf5;
      }
      .notify-title {
        font-weight: 800;
        color: var(--accent);
        font-size: 18px;
      }
      .notify-body {
        padding: 18px;
      }
      .notify-actions {
        display: flex;
        gap: 8px;
        justify-content: flex-end;
        padding: 12px 18px;
        border-top: 1px solid #f3e9f2;
      }
      .notify-success {
        background: linear-gradient(135deg, #fff5fb, #fffafc);
        border: 1px solid #ffd9ec;
      }
      .form-row {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .form-row .col {
        flex: 1;
      }
      .order-list {
        max-width: 1100px;
        margin: 20px auto;
      }
      .order-card {
        background: white;
        padding: 12px;
        border-radius: 12px;
        box-shadow: var(--card-shadow);
        margin-bottom: 12px;
      }
      .order-actions {
        display: flex;
        gap: 8px;
        align-items: center;
      }
      .btn-ghost {
        background: transparent;
        border: 2px solid var(--pink-2);
        color: var(--accent);
        padding: 8px 12px;
        border-radius: 8px;
      }

      /* small tweaks */
      .small-muted {
        font-size: 13px;
        color: var(--muted);
      }
      pre.debug {
        white-space: pre-wrap;
        word-break: break-word;
        font-size: 13px;
        color: #333;
        background: #fff;
        padding: 10px;
        border-radius: 8px;
        box-shadow: var(--card-shadow);
      }

      /* CSS BARU UNTUK FITUR TAMBAHAN */
      .additional-options {
        margin: 16px 0;
        padding: 16px;
        background: var(--pink-1);
        border-radius: 12px;
      }
      .additional-options label {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 12px;
        cursor: pointer;
      }
      .qris-image {
        max-width: 200px;
        margin: 16px auto;
        display: block;
        border-radius: 8px;
        border: 1px solid var(--pink-2);
      }
      .bank-details {
        background: var(--pink-1);
        padding: 16px;
        border-radius: 12px;
        margin: 16px 0;
      }
      .bank-details h4 {
        margin-top: 0;
        margin-bottom: 8px;
        color: var(--accent);
      }
      .bank-details p {
        margin: 4px 0;
        font-family: monospace;
        font-size: 14px;
      }
      .proof-upload {
        margin: 16px 0;
        padding: 16px;
        border: 2px dashed var(--pink-2);
        border-radius: 12px;
        text-align: center;
      }
      .proof-upload input {
        margin: 8px 0;
      }
      .auto-reload-info {
        background: var(--pink-1);
        padding: 8px 12px;
        border-radius: 8px;
        margin: 8px 0;
        font-size: 12px;
        color: var(--muted);
        display: flex;
        align-items: center;
        gap: 8px;
      }

      /* ANIMASI TRANSISI BARU */
      .section-transition {
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 0.5s ease, transform 0.5s ease;
      }

      .section-transition.active {
        opacity: 1;
        transform: translateY(0);
      }

      .fade-in {
        animation: fadeIn 0.5s ease forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .slide-up {
        animation: slideUp 0.5s ease forwards;
      }

      @keyframes slideUp {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .pulse {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body>
    <!-- Floating Cake Character -->
    <div class="cake-character" onclick="showRandomMessage()" title="Klik aku!">
      <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        <ellipse cx="50" cy="85" rx="35" ry="8" fill="#ffb6d5" />
        <rect x="15" y="60" width="70" height="25" rx="5" fill="#ff6fa8" />
        <rect x="15" y="60" width="70" height="8" rx="3" fill="#ffd1e5" />
        <rect x="20" y="40" width="60" height="20" rx="5" fill="#ffb6d5" />
        <rect x="20" y="40" width="60" height="6" rx="3" fill="#ffe0f0" />
        <rect x="25" y="25" width="50" height="15" rx="5" fill="#ff6fa8" />
        <rect x="25" y="25" width="50" height="5" rx="3" fill="#ffd1e5" />
        <circle cx="50" cy="20" r="6" fill="#ff4757" />
        <circle cx="50" cy="20" r="4" fill="#ff6b7a" />
        <ellipse cx="48" cy="18" rx="2" ry="1.5" fill="#ff9aa2" opacity="0.7" />
        <circle cx="30" cy="50" r="2" fill="#fff" />
        <circle cx="45" cy="52" r="2" fill="#fff" />
        <circle cx="60" cy="48" r="2" fill="#fff" />
        <circle cx="35" cy="70" r="2" fill="#fff" />
        <circle cx="50" cy="72" r="2" fill="#fff" />
        <circle cx="65" cy="68" r="2" fill="#fff" />
        <rect x="47" y="10" width="6" height="12" rx="1" fill="#ffd93d" />
        <ellipse cx="50" cy="8" rx="4" ry="3" fill="#ff6348" />
        <ellipse cx="50" cy="6" rx="3" ry="2" fill="#ff8c7a" opacity="0.8" />
      </svg>
    </div>

    <header>
      <div class="brand">
        <div class="logo">
          <img src="logoy.png" alt="MoodyCake Logo" />
        </div>
        <div>
          <div class="brand-name">MoodyCake</div>
          <div class="brand-tagline">‚ú® Made with Love ‚ú®</div>
        </div>
      </div>
      <nav>
        <a onclick="showHome()">Home</a>
        <a onclick="scrollToSection('menu')">Menu</a>
        <a onclick="scrollToSection('testimonials')">Testimoni</a>
        <a onclick="scrollToSection('about')">About</a>
        <a onclick="scrollToSection('check-orders')">Check Pesanan</a>
        <button class="cart-btn" onclick="showCart()">
          üõí Keranjang
          <span class="cart-badge" id="cartBadge">0</span>
        </button>
      </nav>
      <button class="mobile-menu-btn" onclick="toggleMobileMenu()">‚ò∞</button>
    </header>

    <!-- Mobile Menu -->
    <div
      class="mobile-overlay"
      id="mobileOverlay"
      onclick="toggleMobileMenu()"
    ></div>
    <div class="mobile-nav" id="mobileNav">
      <button class="close-mobile-menu" onclick="toggleMobileMenu()">√ó</button>
      <a onclick="showHome(); toggleMobileMenu()">üè† Home</a>
      <a onclick="scrollToSection('menu'); toggleMobileMenu()">üç∞ Menu</a>
      <a onclick="scrollToSection('testimonials'); toggleMobileMenu()"
        >üí¨ Testimoni</a
      >
      <a onclick="scrollToSection('about'); toggleMobileMenu()">‚Ñπ About</a>
      <a onclick="scrollToSection('check-orders'); toggleMobileMenu()"
        >üì¶ Check Pesanan</a
      >
      <button class="cart-btn" onclick="showCart(); toggleMobileMenu()">
        üõí Keranjang
        <span class="cart-badge" id="cartBadgeMobile">0</span>
      </button>
    </div>

    <main id="mainContent">
      <section class="hero section-transition active">
        <div class="hero-left">
          <h1>MoodyCake ‚Äî Kue Cantik & Lezat</h1>
          <p class="lead">
            Koleksi bento cake, custom design, dan kue ulang tahun. Rasa yang
            menyentuh hati.
          </p>
          <div class="btns">
            <button class="btn btn-pink" onclick="scrollToSection('menu')">
              Lihat Menu
            </button>
            <button class="btn btn-outline" onclick="showCart()">
              Lihat Keranjang
            </button>
          </div>

          <div style="margin-top: 18px" class="card-gallery">
            <div class="card" onclick="openQuickView(1)">
              <img src="12.jpg" alt="Mini Cake" />
              <div>
                <div style="font-weight: 700">Mini Cake</div>
                <div style="font-size: 13px; color: var(--muted)">
                  Diameter 12cm, Include 1 lilin kecil & Sterofoam, Free Request
                  Desain
                </div>
                <div class="price">Rp 25.000</div>
              </div>
            </div>

            <div class="card" onclick="openQuickView(2)">
              <img src="13.jpg" alt="Cake Karakter" />
              <div>
                <div style="font-weight: 700">Cake Karakter</div>
                <div style="font-size: 13px; color: var(--muted)">
                  Vanilla, Cokelat, Red Velvet
                </div>
                <div class="price">Rp 85.000</div>
              </div>
            </div>
          </div>
        </div>

        <div class="hero-right">
          <img
            src="center.jpg"
            alt="Featured Cake"
            style="
              width: 100%;
              border-radius: 18px;
              box-shadow: var(--card-shadow);
            "
          />
        </div>
      </section>

      <section
        id="menu"
        class="section-transition"
        style="max-width: 1100px; margin: 0 auto; padding: 0 24px"
      >
        <h2 style="font-family: 'Playfair Display'; font-size: 28px">
          Menu Kami
        </h2>
        <p style="color: var(--muted); margin-top: 6px">
          Jelajahi koleksi kue terbaik kami.
        </p>

        <div class="menu-tabs">
          <button class="tab-btn active" onclick="filterMenu('all')">
            üç∞ Semua Menu
          </button>
          <button class="tab-btn" onclick="filterMenu('featured')">
            ‚≠ê Menu Pilihan
          </button>
        </div>

        <div class="gallery" id="gallery"></div>
      </section>

      <section
        id="about"
        class="section-transition"
        style="
          max-width: 1100px;
          margin: 40px auto;
          padding: 24px;
          background: var(--glass);
          border-radius: 18px;
          box-shadow: var(--card-shadow);
        "
      >
        <h2
          style="
            font-family: 'Playfair Display';
            font-size: 28px;
            margin-top: 0;
          "
        >
          About Moody Cake
        </h2>
        <p style="color: var(--muted); line-height: 1.8">
          MoodyCake adalah Cake shop buatan Kami Bersama Yaitu Nur Annisa
          Chania, Zahra Ramadhani Sanjaya, Zamziatul Latifah
        </p>
        <p style="color: var(--muted); line-height: 1.8">
          Kami melayani custom design untuk berbagai acara spesial Anda. Mari
          wujudkan kue impian Anda bersama MoodyCake! üéÇüíï
        </p>
      </section>

      <!-- Testimonial Section -->
      <section class="testimonial-section section-transition" id="testimonials">
        <h2
          style="
            font-family: 'Playfair Display';
            font-size: 28px;
            text-align: center;
          "
        >
          üí¨ Testimoni Pelanggan
        </h2>
        <p style="color: var(--muted); text-align: center; margin-top: 6px">
          Apa kata mereka tentang MoodyCake?
        </p>

        <div class="testimonial-grid">
          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë©</div>
              <div class="testimonial-info">
                <h4>Sarah Wijaya</h4>
                <p>Jakarta Selatan</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Kue ulang tahun custom untuk anak saya luar biasa! Desainnya
              persis seperti yang diminta dan rasanya enak banget. Semua tamu
              pujian terus!"
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë®</div>
              <div class="testimonial-info">
                <h4>Budi Santoso</h4>
                <p>Tangerang</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Bento cake-nya cute dan enak! Cocok banget buat kado. Harganya
              juga affordable. Pasti bakal order lagi!"
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë©</div>
              <div class="testimonial-info">
                <h4>Putri Amelia</h4>
                <p>Pondok Aren</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Layanan ramah dan cepat! Kuenya selalu fresh dan packaging-nya
              rapi. MoodyCake is the best! üíï"
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë®</div>
              <div class="testimonial-info">
                <h4>Andi Pratama</h4>
                <p>Bintaro</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Rose Pink Delight-nya cantik banget! Istri saya suka sekali.
              Tekstur cake-nya lembut dan tidak terlalu manis."
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë©</div>
              <div class="testimonial-info">
                <h4>Rina Susanti</h4>
                <p>Serpong</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Sudah 3x order untuk acara kantor. Cupcakes-nya selalu jadi
              favorit! Pelayanannya juga oke banget."
            </p>
          </div>

          <div class="testimonial-card">
            <div class="testimonial-header">
              <div class="testimonial-avatar">üë®</div>
              <div class="testimonial-info">
                <h4>Dimas Rizky</h4>
                <p>Ciputat</p>
              </div>
            </div>
            <div class="testimonial-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
            <p class="testimonial-text">
              "Kualitas premium dengan harga yang reasonable. Delivery-nya juga
              tepat waktu. Highly recommended!"
            </p>
          </div>
        </div>
      </section>

      <section class="map-section section-transition" id="location">
        <h2
          style="
            font-family: 'Playfair Display';
            font-size: 28px;
            margin-top: 0;
          "
        >
          üìç Lokasi & Kontak Kami
        </h2>
        <p style="color: var(--muted)">
          Kunjungi toko kami atau hubungi untuk pemesanan
        </p>

        <div class="contact-info">
          <div class="contact-card">
            <div class="contact-icon">üìç</div>
            <div class="contact-details">
              <h4>ALAMAT</h4>
              <p>
                Jl. H. Paten, Pondok Karya<br />Pondok Aren, Tangerang Selatan
              </p>
            </div>
          </div>
          <div class="contact-card">
            <div class="contact-icon">üìû</div>
            <div class="contact-details">
              <h4>TELEPON</h4>
              <p>+62 812-3456-7890</p>
            </div>
          </div>
          <div class="contact-card">
            <div class="contact-icon">üïí</div>
            <div class="contact-details">
              <h4>JAM BUKA</h4>
              <p>Senin - Sabtu: 08:00 - 20:00<br />Minggu: 09:00 - 18:00</p>
            </div>
          </div>
        </div>

        <div class="map-container">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3965.3314520304044!2d106.73823631476945!3d-6.346234195407943!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69e579c5f0e74b%3A0x5e8e897f8f1e8b7a!2sJl.%20H.%20Paten%2C%20Pondok%20Karya%2C%20Kec.%20Pd.%20Aren%2C%20Kota%20Tangerang%20Selatan%2C%20Banten!5e0!3m2!1sen!2sid!4v1234567890"
            allowfullscreen=""
            loading="lazy"
            referrerpolicy="no-referrer-when-downgrade"
          >
          </iframe>
        </div>
      </section>

      <!-- Check Orders Section -->
      <section
        id="check-orders"
        class="section-transition"
        style="max-width: 1100px; margin: 40px auto; padding: 24px"
      >
        <h2
          style="
            font-family: 'Playfair Display';
            font-size: 28px;
            margin-top: 0;
          "
        >
          üì¶ Check Pesanan Anda
        </h2>
        <p style="color: var(--muted)">
          Di sini Anda bisa melihat status pesanan. (Untuk demo ada tombol
          update status dan upload bukti bayar.)
        </p>
        <div class="auto-reload-info">
          <span>üîÑ Data akan diperbarui otomatis setiap 30 detik</span>
        </div>
        <div id="ordersContainer" class="order-list"></div>
      </section>
    </main>

    <!-- Cart Page -->
    <div class="cart-page" id="cartPage">
      <h2
        style="
          font-family: 'Playfair Display';
          font-size: 32px;
          margin-bottom: 20px;
        "
      >
        üõí Keranjang Belanja
      </h2>
      <div id="cartItems"></div>
      <div class="cart-summary" id="cartSummary" style="display: none">
        <h3 style="margin-top: 0">Ringkasan Pesanan</h3>
        <div
          style="display: flex; justify-content: space-between; margin: 12px 0"
        >
          <span>Total Item:</span>
          <strong id="totalItems">0</strong>
        </div>
        <div
          style="
            display: flex;
            justify-content: space-between;
            margin: 12px 0;
            font-size: 20px;
          "
        >
          <strong>Total Harga:</strong>
          <strong style="color: var(--pink-3)" id="totalPrice">Rp 0</strong>
        </div>
        <button
          class="btn btn-pink"
          style="width: 100%; margin-top: 16px"
          id="btnProceedCheckout"
        >
          Checkout
        </button>
        <button
          class="btn btn-outline"
          style="width: 100%; margin-top: 8px"
          onclick="showHome()"
        >
          Lanjut Belanja
        </button>
      </div>
    </div>

    <!-- Modal: Product Quick View -->
    <div class="modal" id="productModal" onclick="closeModalOnBackdrop(event)">
      <div class="modal-content">
        <div class="modal-header">
          <h2
            id="modalTitle"
            style="margin: 0; font-family: 'Playfair Display'"
          ></h2>
          <button class="close-btn" onclick="closeModal()">&times;</button>
        </div>
        <div class="modal-body">
          <img
            id="modalImage"
            src=""
            alt=""
            style="width: 100%; border-radius: 12px; margin-bottom: 12px"
          />
          <div id="modalBadge"></div>
          <p
            id="modalDescription"
            style="color: var(--muted); margin-bottom: 12px"
          ></p>
          <div class="price" id="modalPrice" style="font-size: 24px"></div>

          <div class="quantity-control">
            <button class="qty-btn" onclick="decreaseQty()">‚àí</button>
            <span class="qty-display" id="qtyDisplay">1</span>
            <button class="qty-btn" onclick="increaseQty()">+</button>
          </div>

          <!-- Opsi Tambahan Baru -->
          <div class="additional-options">
            <h4 style="margin-top: 0; margin-bottom: 12px">Opsi Tambahan:</h4>
            <label
              ><input type="checkbox" id="modalAddBox" /> Tambah Box Coklat (+Rp
              5.000)</label
            >
            <label
              ><input type="checkbox" id="modalAddCard" /> Tambah Kartu Ucapan
              (+Rp 3.000)</label
            >
            <label
              ><input type="checkbox" id="modalAddCandle" /> Tambah Lilin Hias
              (+Rp 2.000)</label
            >
            <label
              ><input type="checkbox" id="modalAddGiftBag" /> Tambah Tas Kado
              (+Rp 4.000)</label
            >
          </div>

          <button
            class="btn btn-pink"
            style="width: 100%"
            id="modalAddToCartBtn"
          >
            üõí Tambah ke Keranjang
          </button>
        </div>
      </div>
    </div>

    <!-- Modal: LOGIN -->
    <div class="modal" id="loginModalSmall">
      <div class="modal-content small-form">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 18px;
            border-bottom: 1px solid #f6f3f6;
          "
        >
          <h3 style="margin: 0">Login</h3>
          <button class="close-btn" onclick="closeAuthModals()">&times;</button>
        </div>
        <div style="padding: 18px">
          <input
            id="loginEmail"
            type="email"
            placeholder="Email"
            style="
              padding: 10px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 8px;
              border: 1px solid #eee;
            "
          />
          <input
            id="loginPassword"
            type="password"
            placeholder="Password"
            style="
              padding: 10px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 8px;
              border: 1px solid #eee;
            "
          />
          <div style="display: flex; gap: 8px">
            <button class="btn btn-pink" onclick="handleLogin()">Login</button>
            <button class="btn-ghost" onclick="showRegisterModal()">
              Daftar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: REGISTER -->
    <div class="modal" id="registerModalSmall">
      <div class="modal-content small-form">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 18px;
            border-bottom: 1px solid #f6f3f6;
          "
        >
          <h3 style="margin: 0">Daftar Akun</h3>
          <button class="close-btn" onclick="closeAuthModals()">&times;</button>
        </div>
        <div style="padding: 18px">
          <input
            id="regName"
            type="text"
            placeholder="Nama Lengkap"
            style="
              padding: 10px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 8px;
              border: 1px solid #eee;
            "
          />
          <input
            id="regEmail"
            type="email"
            placeholder="Email"
            style="
              padding: 10px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 8px;
              border: 1px solid #eee;
            "
          />
          <input
            id="regPassword"
            type="password"
            placeholder="Password"
            style="
              padding: 10px;
              width: 100%;
              margin-bottom: 8px;
              border-radius: 8px;
              border: 1px solid #eee;
            "
          />
          <div style="display: flex; gap: 8px">
            <button class="btn btn-pink" onclick="handleRegister()">
              Daftar
            </button>
            <button class="btn-ghost" onclick="showLoginModal()">Login</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal: CHECKOUT FORM -->
    <div
      class="modal"
      id="checkoutModalFull"
      onclick="closeModalOnBackdrop(event)"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h3 style="margin: 0">Form Checkout</h3>
          <button class="close-btn" onclick="closeCheckoutModal()">
            &times;
          </button>
        </div>
        <div class="modal-body">
          <div style="display: flex; gap: 8px; flex-wrap: wrap">
            <input
              id="checkoutName"
              placeholder="Nama Penerima"
              style="
                padding: 10px;
                border-radius: 8px;
                border: 1px solid #eee;
                width: 100%;
                margin-bottom: 8px;
              "
            />
            <input
              id="checkoutPhone"
              placeholder="No Telepon"
              style="
                padding: 10px;
                border-radius: 8px;
                border: 1px solid #eee;
                width: 100%;
                margin-bottom: 8px;
              "
            />
            <textarea
              id="checkoutAddress"
              placeholder="Alamat lengkap"
              style="
                padding: 10px;
                border-radius: 8px;
                border: 1px solid #eee;
                width: 100%;
                margin-bottom: 8px;
              "
            ></textarea>
            <textarea
              id="checkoutRequest"
              placeholder="Request Desain (opsional)"
              style="
                padding: 10px;
                border-radius: 8px;
                border: 1px solid #eee;
                width: 100%;
                margin-bottom: 8px;
              "
            ></textarea>

            <!-- Opsi Tambahan di Checkout -->
            <div class="additional-options" style="width: 100%">
              <h4 style="margin-top: 0; margin-bottom: 12px">Opsi Tambahan:</h4>
              <label style="display: flex; align-items: center; gap: 8px"
                ><input id="checkoutBox" type="checkbox" /> Tambah Box Coklat
                (+Rp 5.000 per order)</label
              >
              <label style="display: flex; align-items: center; gap: 8px"
                ><input id="checkoutCard" type="checkbox" /> Tambah Kartu Ucapan
                (+Rp 3.000 per order)</label
              >
              <label style="display: flex; align-items: center; gap: 8px"
                ><input id="checkoutCandle" type="checkbox" /> Tambah Lilin Hias
                (+Rp 2.000 per order)</label
              >
              <label style="display: flex; align-items: center; gap: 8px"
                ><input id="checkoutGiftBag" type="checkbox" /> Tambah Tas Kado
                (+Rp 4.000 per order)</label
              >
            </div>

            <div style="width: 100%">
              <label
                style="display: block; margin-bottom: 6px; font-weight: 700"
                >Opsi Pengiriman (Hanya GoSend)</label
              >
              <select
                id="checkoutCourier"
                style="
                  padding: 10px;
                  border-radius: 8px;
                  border: 1px solid #eee;
                  width: 100%;
                "
              >
                <option value="gosend|15000">
                  GoSend - Reguler (Rp 15.000)
                </option>
                <option value="gosend|25000">
                  GoSend - Instant (Rp 25.000)
                </option>
              </select>
            </div>

            <div style="margin-top: 8px; width: 100%">
              <label
                style="display: block; margin-bottom: 6px; font-weight: 700"
                >Metode Pembayaran</label
              >
              <select
                id="checkoutPayment"
                style="
                  padding: 10px;
                  border-radius: 8px;
                  border: 1px solid #eee;
                  width: 100%;
                "
              >
                <option value="Transfer">Transfer Bank</option>
                <option value="QRIS">QRIS</option>
              </select>
            </div>

            <!-- QRIS Payment Section -->
            <div id="qrisPaymentSection" style="display: none; width: 100%">
              <div class="bank-details">
                <h4>Pembayaran QRIS</h4>
                <p>Scan QR code di bawah untuk pembayaran:</p>
                <img src="qris.jpg" alt="QRIS Code" class="qris-image" />
              </div>
            </div>

            <!-- Transfer Payment Section -->
            <div id="transferPaymentSection" style="display: none; width: 100%">
              <div class="bank-details">
                <h4>Transfer Bank</h4>
                <p>Silakan transfer ke rekening berikut:</p>
                <p>
                  <strong>Bank Seabank:</strong> 901035532140 (Nur Annisa Chaia)
                </p>
              </div>
              <div class="proof-upload">
                <p>Upload bukti transfer setelah melakukan pembayaran:</p>
                <input type="file" id="transferProof" accept="image/*" />
              </div>
            </div>

            <div
              style="
                width: 100%;
                margin-top: 12px;
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              <div>
                <div style="font-size: 13px; color: var(--muted)">Subtotal</div>
                <div
                  id="checkoutSubtotal"
                  style="font-weight: 800; font-size: 18px"
                >
                  Rp 0
                </div>
              </div>
              <div>
                <div style="font-size: 13px; color: var(--muted)">Ongkir</div>
                <div
                  id="checkoutOngkir"
                  style="font-weight: 800; font-size: 18px"
                >
                  Rp 0
                </div>
              </div>
              <div>
                <div style="font-size: 13px; color: var(--muted)">Total</div>
                <div
                  id="checkoutTotal"
                  style="
                    font-weight: 900;
                    font-size: 20px;
                    color: var(--pink-3);
                  "
                >
                  Rp 0
                </div>
              </div>
            </div>
          </div>

          <div style="display: flex; gap: 8px; margin-top: 12px">
            <button class="btn btn-pink" onclick="submitCheckout()">
              Kirim & Buat Pesanan
            </button>
            <button class="btn-ghost" onclick="closeCheckoutModal()">
              Batal
            </button>
          </div>
          <p style="color: var(--muted); margin-top: 10px; font-size: 13px">
            Setelah membuat pesanan, status awal akan
            <strong>Menunggu Pembayaran</strong>. Kamu bisa lihat status di menu
            Check Pesanan.
          </p>
        </div>
      </div>
    </div>

    <!-- Modal: NOTIFICATION (modern big modal used instead of alert/confirm) -->
    <div class="modal" id="notifyModal">
      <div class="modal-content" style="max-width: 520px">
        <div class="notify-header">
          <div class="notify-icon" id="notifyIcon">üéÇ</div>
          <div>
            <div class="notify-title" id="notifyTitle">Notifikasi</div>
            <div
              style="font-size: 13px; color: var(--muted)"
              id="notifySub"
            ></div>
          </div>
        </div>
        <div
          class="notify-body"
          id="notifyBody"
          style="padding: 18px; color: var(--accent)"
        ></div>
        <div class="notify-actions" id="notifyActions">
          <button class="btn btn-outline" onclick="closeNotify()">Tutup</button>
        </div>
      </div>
    </div>

    <footer>
      <p>
        <strong>MoodyCake</strong> &mdash; Cake shop kecil dengan sentuhan pink.
        Follow kami di Instagram: <em>@moodycake.id</em>
      </p>
      <small>¬© MoodyCake 2025</small>
    </footer>

    <script>
      /* ========================= DATA & STATE ========================= */
      const products = [
        {
          id: 1,
          name: "Mini Cake",
          description:
            "Cake Ukuran 12dm, Sudah include lilin kecil dan sterofoam. Cocok untuk 1-2 orang.",
          price: 25000,
          image: "12.jpg",
          featured: true,
          badge: "featured",
        },
        {
          id: 2,
          name: "Cake Karakter",
          description:
            "Ukuran Cake 16dm, Sudah include 1 Lilin Besar, Pisau, Box Coklat. Pilihan karakter lucu.",
          price: 120000,
          image: "13.jpg",
          featured: true,
          badge: "popular",
        },
        {
          id: 3,
          name: "Korean Cake 14dm",
          description:
            "Kue lapis lembut dengan cream yang manisnya pas. Tekstur yang memanjakan lidah.",
          price: 45000,
          image: "14.jpg",
          featured: false,
          badge: "new",
        },
        {
          id: 4,
          name: "Bento Cake Strawberry",
          description:
            "Bento cake dengan rasa strawberry segar, ukuran kecil cocok untuk hadiah spesial.",
          price: 35000,
          image:
            "https://images.unsplash.com/photo-1578985545062-69928b1d9587?w=300&h=200&fit=crop",
          featured: true,
          badge: "featured",
        },
        {
          id: 5,
          name: "Bento Cake Chocolate",
          description:
            "Bento cake dengan coklat premium Belgia, lembut dan tidak terlalu manis.",
          price: 35000,
          image:
            "https://images.unsplash.com/photo-1563729784474-d77dbb933a9e?w=300&h=200&fit=crop",
          featured: false,
          badge: "new",
        },
        {
          id: 6,
          name: "Custom Cake Unicorn",
          description:
            "Custom cake dengan tema unicorn, warna-warni dan magical. Perfect untuk birthday!",
          price: 150000,
          image:
            "https://images.unsplash.com/photo-1559620192-032c4bc4674e?w=300&h=200&fit=crop",
          featured: true,
          badge: "popular",
        },
        {
          id: 7,
          name: "Cake Butterfly",
          description:
            "Custom cake karakter Spongebob, cocok untuk ulang tahun anak. Warna cerah dan menarik.",
          price: 90000,
          image: "17.png",
          featured: false,
          badge: "new",
        },
        {
          id: 8,
          name: "Birthday Cake 2 Tier",
          description:
            "Kue ulang tahun 2 tingkat dengan hiasan bunga dan dekorasi elegan. Cocok untuk acara spesial.",
          price: 250000,
          image:
            "https://images.unsplash.com/photo-1535254973040-607b474cb50d?w=300&h=200&fit=crop",
          featured: true,
          badge: "featured",
        },
        {
          id: 9,
          name: "Birthday Cake Number",
          description:
            "Kue ulang tahun bentuk angka, bisa request angka sesuai usia. Desain simple tapi elegan.",
          price: 120000,
          image:
            "https://images.unsplash.com/photo-1588195538326-c5b1e9f80a1b?w=300&h=200&fit=crop",
          featured: false,
          badge: "new",
        },
        {
          id: 10,
          name: "Cupcake Set 6pcs",
          description:
            "Set cupcake 6 buah dengan berbagai topping dan rasa. Perfect untuk gathering kantor.",
          price: 75000,
          image:
            "https://images.unsplash.com/photo-1486427944299-d1955d23e34d?w=300&h=200&fit=crop",
          featured: true,
          badge: "popular",
        },
        {
          id: 11,
          name: "Red Velvet Cake",
          description:
            "Kue red velvet dengan cream cheese frosting yang lembut. Rasa yang iconic dan memikat.",
          price: 95000,
          image:
            "https://images.unsplash.com/photo-1587314168485-3236d6710814?w=300&h=200&fit=crop",
          featured: false,
          badge: "new",
        },
        {
          id: 12,
          name: "Tiramisu Cake",
          description:
            "Kue tiramisu dengan kopi Italia asli dan mascarpone. Rasa yang sophisticated dan elegan.",
          price: 110000,
          image:
            "https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=300&h=200&fit=crop",
          featured: true,
          badge: "popular",
        },
      ];

      // LocalStorage keys
      const LS_USERS = "mc_users_v2";
      const LS_CURR = "mc_currentUser_v2";
      const LS_CART = "mc_cart_v2";
      const LS_ORD = "mc_orders_v2";

      // load
      let users = JSON.parse(localStorage.getItem(LS_USERS) || "[]");
      let currentUser = JSON.parse(localStorage.getItem(LS_CURR) || "null");
      let cart = JSON.parse(localStorage.getItem(LS_CART) || "[]");
      let orders = JSON.parse(localStorage.getItem(LS_ORD) || "[]");

      // Auto-reload interval
      let autoReloadInterval;

      function persistAll() {
        localStorage.setItem(LS_USERS, JSON.stringify(users));
        localStorage.setItem(LS_CURR, JSON.stringify(currentUser));
        localStorage.setItem(LS_CART, JSON.stringify(cart));
        localStorage.setItem(LS_ORD, JSON.stringify(orders));
      }

      /* ========================= INIT UI ========================= */
      document.addEventListener("DOMContentLoaded", () => {
        renderProducts();
        updateCartBadge();
        renderCart();
        renderOrders();
        attachListeners();
        updateAuthUI();
        startAutoReload();

        // Animasi transisi untuk section
        animateSections();
      });

      function animateSections() {
        const sections = document.querySelectorAll(".section-transition");
        sections.forEach((section) => {
          section.classList.add("active");
        });
      }

      function startAutoReload() {
        // Auto-reload data setiap 30 detik
        autoReloadInterval = setInterval(() => {
          // Reload data dari localStorage
          users = JSON.parse(localStorage.getItem(LS_USERS) || "[]");
          currentUser = JSON.parse(localStorage.getItem(LS_CURR) || "null");
          cart = JSON.parse(localStorage.getItem(LS_CART) || "[]");
          orders = JSON.parse(localStorage.getItem(LS_ORD) || "[]");

          // Update UI
          updateCartBadge();
          renderCart();
          renderOrders();
          updateAuthUI();

          console.log("Data auto-reloaded");
        }, 30000); // 30 detik
      }

      function attachListeners() {
        // modal add to cart
        const btn = document.getElementById("modalAddToCartBtn");
        if (btn) btn.addEventListener("click", () => addToCartFromModal());
        // checkout proceed
        const proceed = document.getElementById("btnProceedCheckout");
        if (proceed)
          proceed.addEventListener("click", () => {
            if (cart.length === 0) {
              showNotify(
                "Keranjang Kosong",
                "Silakan tambahkan produk terlebih dahulu",
                "warning"
              );
              return;
            }
            if (!currentUser) {
              showNotify(
                "Harap Login",
                "Silakan login dahulu sebelum checkout",
                "warning",
                [
                  {
                    label: "Login",
                    className: "btn btn-pink",
                    onClick: showLoginModal,
                  },
                ]
              );
              return;
            }
            openCheckoutModal();
          });
        // checkout total updates
        [
          "checkoutCourier",
          "checkoutBox",
          "checkoutCard",
          "checkoutCandle",
          "checkoutGiftBag",
          "checkoutPayment",
        ].forEach((id) => {
          const el = document.getElementById(id);
          if (el) el.addEventListener("change", refreshCheckoutTotals);
        });

        // Payment method change listener
        const paymentSelect = document.getElementById("checkoutPayment");
        if (paymentSelect) {
          paymentSelect.addEventListener("change", togglePaymentSections);
        }
      }

      function togglePaymentSections() {
        const paymentMethod = document.getElementById("checkoutPayment").value;
        const qrisSection = document.getElementById("qrisPaymentSection");
        const transferSection = document.getElementById(
          "transferPaymentSection"
        );

        if (paymentMethod === "QRIS") {
          qrisSection.style.display = "block";
          transferSection.style.display = "none";
        } else if (paymentMethod === "Transfer") {
          qrisSection.style.display = "none";
          transferSection.style.display = "block";
        } else {
          qrisSection.style.display = "none";
          transferSection.style.display = "none";
        }
      }

      /* ========================= NOTIFY (replaces alert/confirm) ========================= */
      function showNotify(title, body = "", type = "info", actions = []) {
        const modal = document.getElementById("notifyModal");
        document.getElementById("notifyTitle").textContent = title || "Pesan";
        document.getElementById("notifyBody").textContent = body || "";
        document.getElementById("notifySub").textContent =
          type === "error" ? "Terjadi kesalahan" : "";
        const icon = document.getElementById("notifyIcon");
        const actionsContainer = document.getElementById("notifyActions");
        // style icon
        if (type === "success") {
          icon.textContent = "‚úÖ";
          icon.style.background = "linear-gradient(135deg,#6ee7b7,#34d399)";
        } else if (type === "error") {
          icon.textContent = "‚ö†Ô∏è";
          icon.style.background = "linear-gradient(135deg,#ff6b6b,#ffb6d5)";
        } else if (type === "warning") {
          icon.textContent = "‚ö†";
          icon.style.background = "linear-gradient(135deg,#ffd27a,#ffb6d5)";
        } else {
          icon.textContent = "üéÇ";
          icon.style.background =
            "linear-gradient(135deg, var(--pink-3), var(--accent))";
        }

        actionsContainer.innerHTML = "";
        // custom actions
        if (Array.isArray(actions) && actions.length) {
          actions.forEach((act) => {
            const b = document.createElement("button");
            b.className = act.className || "btn btn-pink";
            b.textContent = act.label || "OK";
            b.onclick = () => {
              if (typeof act.onClick === "function") act.onClick();
              closeNotify();
            };
            actionsContainer.appendChild(b);
          });
        }
        // default close
        const closeBtn = document.createElement("button");
        closeBtn.className = "btn btn-outline";
        closeBtn.textContent = "Tutup";
        closeBtn.onclick = closeNotify;
        actionsContainer.appendChild(closeBtn);

        modal.classList.add("active");
        document.body.style.overflow = "hidden";
      }
      function closeNotify() {
        const modal = document.getElementById("notifyModal");
        modal.classList.remove("active");
        document.body.style.overflow = "auto";
      }

      /* ========================= NAVIGASI ========================= */
      function scrollToSection(sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
          // Animasi transisi untuk section
          section.classList.remove("active");

          setTimeout(() => {
            section.scrollIntoView({ behavior: "smooth" });
            section.classList.add("active");
          }, 100);
        }
      }

      function showHome() {
        document.getElementById("mainContent").style.display = "block";
        document.getElementById("cartPage").classList.remove("active");
        window.scrollTo({ top: 0, behavior: "smooth" });
      }

      function toggleMobileMenu() {
        const mobileNav = document.getElementById("mobileNav");
        const mobileOverlay = document.getElementById("mobileOverlay");
        const isActive = mobileNav.classList.contains("active");

        if (isActive) {
          mobileNav.classList.remove("active");
          mobileOverlay.classList.remove("active");
        } else {
          mobileNav.classList.add("active");
          mobileOverlay.classList.add("active");
        }
      }

      /* ========================= CORE (products/cart) ========================= */
      function renderProducts(filter = "all") {
        const gallery = document.getElementById("gallery");

        let filteredProducts = products;

        if (filter === "featured") {
          filteredProducts = products.filter((p) => p.featured);
        }

        gallery.innerHTML = filteredProducts
          .map((p) => {
            const badgeLabel = p.badge
              ? p.badge === "featured"
                ? "‚≠ê Pilihan"
                : p.badge === "popular"
                ? "üî• Populer"
                : "‚ú® Baru"
              : "";
            return `
          <article class="product" onclick="openQuickView(${p.id})">
            <img src="${p.image}" alt="${p.name}">
            <div class="meta">
              ${
                p.badge
                  ? `<span class="badge badge-${p.badge}">${badgeLabel}</span>`
                  : ""
              }
              <h3>${p.name}</h3>
              <p>${p.description}</p>
              <div class="price">Rp ${p.price.toLocaleString("id-ID")}</div>
            </div>
          </article>
        `;
          })
          .join("");
      }

      let currentProductFromModal = null;
      let currentQty = 1;

      function openQuickView(productId) {
        currentProductFromModal = products.find((p) => p.id === productId);
        if (!currentProductFromModal) return;
        currentQty = 1;
        document.getElementById("modalTitle").textContent =
          currentProductFromModal.name;
        document.getElementById("modalImage").src =
          currentProductFromModal.image;
        document.getElementById("modalDescription").textContent =
          currentProductFromModal.description;
        document.getElementById("modalPrice").textContent =
          "Rp " + currentProductFromModal.price.toLocaleString("id-ID");
        document.getElementById("qtyDisplay").textContent = currentQty;
        document.getElementById("modalAddBox").checked = false;
        document.getElementById("modalAddCard").checked = false;
        document.getElementById("modalAddCandle").checked = false;
        document.getElementById("modalAddGiftBag").checked = false;
        const badgeHtml = currentProductFromModal.badge
          ? `<span class="badge badge-${
              currentProductFromModal.badge
            }" style="margin-bottom:12px">${
              currentProductFromModal.badge === "featured"
                ? "‚≠ê Pilihan"
                : currentProductFromModal.badge === "popular"
                ? "üî• Populer"
                : "‚ú® Baru"
            }</span>`
          : "";
        document.getElementById("modalBadge").innerHTML = badgeHtml;
        document.getElementById("productModal").classList.add("active");
        document.body.style.overflow = "hidden";
      }
      function closeModal() {
        document.getElementById("productModal").classList.remove("active");
        document.body.style.overflow = "auto";
      }
      function closeModalOnBackdrop(event) {
        if (event.target.id === "productModal") closeModal();
        if (event.target.id === "checkoutModalFull") closeCheckoutModal();
      }
      function increaseQty() {
        currentQty++;
        document.getElementById("qtyDisplay").textContent = currentQty;
      }
      function decreaseQty() {
        if (currentQty > 1) {
          currentQty--;
          document.getElementById("qtyDisplay").textContent = currentQty;
        }
      }

      /* ========================= AUTH ========================= */
      function showLoginModal() {
        document.getElementById("loginModalSmall").classList.add("active");
        document.body.style.overflow = "hidden";
      }
      function showRegisterModal() {
        document.getElementById("registerModalSmall").classList.add("active");
        document.body.style.overflow = "hidden";
      }
      function closeAuthModals() {
        document.getElementById("loginModalSmall").classList.remove("active");
        document
          .getElementById("registerModalSmall")
          .classList.remove("active");
        document.body.style.overflow = "auto";
      }

      function handleRegister() {
        const name = document.getElementById("regName").value.trim();
        const email = document
          .getElementById("regEmail")
          .value.trim()
          .toLowerCase();
        const pass = document.getElementById("regPassword").value;
        if (!name || !email || !pass) {
          showNotify("Registrasi Gagal", "Lengkapi semua data.", "error");
          return;
        }
        if (users.find((u) => u.email === email)) {
          showNotify(
            "Registrasi",
            "Email sudah terdaftar. Silakan login.",
            "warning",
            [
              {
                label: "Login",
                className: "btn btn-pink",
                onClick: showLoginModal,
              },
            ]
          );
          closeAuthModals();
          return;
        }
        users.push({ name, email, pass });
        persistAll();
        closeAuthModals();
        showNotify(
          "Registrasi Berhasil",
          "Akun berhasil dibuat. Silakan login.",
          "success",
          [
            {
              label: "Login",
              className: "btn btn-pink",
              onClick: showLoginModal,
            },
          ]
        );
      }

      function handleLogin() {
        const email = document
          .getElementById("loginEmail")
          .value.trim()
          .toLowerCase();
        const pass = document.getElementById("loginPassword").value;
        const u = users.find((x) => x.email === email && x.pass === pass);
        if (u) {
          currentUser = { name: u.name, email: u.email };
          persistAll();
          closeAuthModals();
          showNotify(
            "Login Berhasil",
            "Halo, " + currentUser.name + "!",
            "success"
          );
          updateAuthUI();
          renderOrders();
        } else {
          showNotify(
            "Login Gagal",
            "Email atau password salah. Coba lagi atau daftar jika belum punya akun.",
            "error",
            [
              {
                label: "Daftar",
                className: "btn btn-outline",
                onClick: showRegisterModal,
              },
            ]
          );
        }
      }

      function logout() {
        showNotify("Konfirmasi Logout", "Yakin ingin logout?", "warning", [
          {
            label: "Ya, Logout",
            className: "btn btn-pink",
            onClick: () => {
              currentUser = null;
              persistAll();
              updateAuthUI();
              showNotify("Keluar", "Anda telah logout.", "success");
            },
          },
        ]);
      }

      function updateAuthUI() {
        // remove old control if exists
        const old = document.getElementById("userControl");
        if (old) old.remove();
        const container = document.createElement("div");
        container.id = "userControl";
        container.style.display = "flex";
        container.style.alignItems = "center";
        container.style.gap = "8px";
        if (currentUser) {
          const hello = document.createElement("div");
          hello.textContent = "Halo, " + currentUser.name;
          hello.style.fontWeight = "700";
          hello.style.color = "var(--muted)";
          const chkBtn = document.createElement("button");
          chkBtn.className = "btn-ghost";
          chkBtn.textContent = "Check Pesanan";
          chkBtn.onclick = () => scrollToSection("check-orders");

          const logoutBtn = document.createElement("button");
          logoutBtn.className = "btn-ghost";
          logoutBtn.textContent = "Logout";
          logoutBtn.onclick = logout;

          container.appendChild(hello);
          container.appendChild(chkBtn);
          container.appendChild(logoutBtn);
        } else {
          const loginBtn = document.createElement("button");
          loginBtn.className = "cart-btn";
          loginBtn.style.background = "var(--pink-3)";
          loginBtn.style.color = "white";
          loginBtn.textContent = "Login / Daftar";
          loginBtn.onclick = showLoginModal;
          container.appendChild(loginBtn);
        }
        document.querySelector("header").appendChild(container);
      }

      /* ========================= CART (wajib login) ========================= */
      function addToCartFromModal() {
        if (!currentUser) {
          showNotify(
            "Harap Login",
            "Silakan login terlebih dahulu untuk menambah ke keranjang.",
            "warning",
            [
              {
                label: "Login",
                className: "btn btn-pink",
                onClick: showLoginModal,
              },
            ]
          );
          return;
        }
        if (!currentProductFromModal) return;
        const qty = currentQty || 1;
        const box = document.getElementById("modalAddBox").checked;
        const card = document.getElementById("modalAddCard").checked;
        const candle = document.getElementById("modalAddCandle").checked;
        const giftBag = document.getElementById("modalAddGiftBag").checked;

        addItemToCart(currentProductFromModal.id, qty, {
          box,
          card,
          candle,
          giftBag,
        });
        closeModal();
        showNotify("Berhasil", "Produk ditambahkan ke keranjang.", "success", [
          {
            label: "Lihat Keranjang",
            className: "btn btn-outline",
            onClick: showCart,
          },
        ]);
      }

      // backward-compatible addToCart (keamanan: memaksa login)
      function addToCart(idOrName, priceOrQty) {
        if (typeof idOrName === "number") {
          const prod = products.find((p) => p.id === idOrName);
          const qty = typeof priceOrQty === "number" ? priceOrQty : 1;
          if (!currentUser) {
            showNotify(
              "Harap Login",
              "Silakan login terlebih dahulu untuk menambah ke keranjang.",
              "warning",
              [
                {
                  label: "Login",
                  className: "btn btn-pink",
                  onClick: showLoginModal,
                },
              ]
            );
            return;
          }
          addItemToCart(prod.id, qty, {
            box: false,
            card: false,
            candle: false,
            giftBag: false,
          });
          showNotify(
            "Berhasil",
            `${prod.name} (${qty}x) ditambahkan ke keranjang.`,
            "success",
            [
              {
                label: "Lihat Keranjang",
                className: "btn btn-outline",
                onClick: showCart,
              },
            ]
          );
          return;
        }
        if (!currentUser) {
          showNotify(
            "Harap Login",
            "Silakan login terlebih dahulu untuk menambah ke keranjang.",
            "warning",
            [
              {
                label: "Login",
                className: "btn btn-pink",
                onClick: showLoginModal,
              },
            ]
          );
          return;
        }
        const name = idOrName;
        const price = priceOrQty || 0;
        cart.push({
          id: "ad-hoc-" + Date.now(),
          name,
          price,
          qty: 1,
          box: false,
          card: false,
          candle: false,
          giftBag: false,
        });
        persistAll();
        updateCartBadge();
        renderCart();
        showNotify("Berhasil", "Item ditambahkan ke keranjang.", "success", [
          {
            label: "Lihat Keranjang",
            className: "btn btn-outline",
            onClick: showCart,
          },
        ]);
      }

      function addItemToCart(productId, qty = 1, options = {}) {
        const prod = products.find((p) => p.id === productId);
        if (!prod) return;

        // Check if item with same options exists
        const existing = cart.find(
          (i) =>
            i.id === productId &&
            i.box === options.box &&
            i.card === options.card &&
            i.candle === options.candle &&
            i.giftBag === options.giftBag
        );

        if (existing) {
          existing.qty += qty;
        } else {
          cart.push({
            id: productId,
            name: prod.name,
            price: prod.price,
            qty: qty,
            box: options.box || false,
            card: options.card || false,
            candle: options.candle || false,
            giftBag: options.giftBag || false,
          });
        }
        persistAll();
        updateCartBadge();
        renderCart();
      }

      function updateCartBadge() {
        const totalItems = cart.reduce((s, i) => s + i.qty, 0);
        const el1 = document.getElementById("cartBadge");
        const el2 = document.getElementById("cartBadgeMobile");
        if (el1) el1.textContent = totalItems;
        if (el2) el2.textContent = totalItems;
      }

      function showCart() {
        document.getElementById("mainContent").style.display = "none";
        document.getElementById("cartPage").classList.add("active");
        window.scrollTo({ top: 0, behavior: "smooth" });
        renderCart();
      }

      function renderCart() {
        const cartItems = document.getElementById("cartItems");
        const cartSummary = document.getElementById("cartSummary");

        if (cart.length === 0) {
          cartItems.innerHTML = `
          <div class="empty-cart">
            <h3>üõí Keranjang Kosong</h3>
            <p>Belum ada produk di keranjang Anda</p>
            <button class="btn btn-pink" onclick="showHome()">Mulai Belanja</button>
          </div>
        `;
          cartSummary.style.display = "none";
          updateCartBadge();
          return;
        }

        cartItems.innerHTML = cart
          .map(
            (item, index) => `
        <div class="cart-item">
          <img src="${
            typeof item.id === "number"
              ? (products.find((p) => p.id === item.id) || {}).image
              : "https://via.placeholder.com/150"
          }" alt="${item.name}">
          <div class="cart-item-info">
            <h3 style="margin:0 0 4px">${item.name}</h3>
            <div class="price">Rp ${item.price.toLocaleString("id-ID")}</div>
            <div style="font-size:13px;color:var(--muted)">
              ${item.box ? "+ Box Coklat<br>" : ""}
              ${item.card ? "+ Kartu Ucapan<br>" : ""}
              ${item.candle ? "+ Lilin Hias<br>" : ""}
              ${item.giftBag ? "+ Tas Kado<br>" : ""}
            </div>
          </div>
          <div class="cart-item-actions">
            <button class="qty-btn" onclick="updateCartQty(${index}, -1)">‚àí</button>
            <span class="qty-display">${item.qty}</span>
            <button class="qty-btn" onclick="updateCartQty(${index}, 1)">+</button>
            <button class="remove-btn" onclick="removeFromCart(${index})">Hapus</button>
          </div>
        </div>
      `
          )
          .join("");

        const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
        const totalPrice = cart.reduce(
          (sum, item) =>
            sum +
            item.price * item.qty +
            (item.box ? 5000 * item.qty : 0) +
            (item.card ? 3000 * item.qty : 0) +
            (item.candle ? 2000 * item.qty : 0) +
            (item.giftBag ? 4000 * item.qty : 0),
          0
        );

        document.getElementById("totalItems").textContent = totalItems;
        document.getElementById("totalPrice").textContent =
          "Rp " + totalPrice.toLocaleString("id-ID");
        cartSummary.style.display = "block";
        updateCartBadge();
      }

      function updateCartQty(index, change) {
        cart[index].qty += change;
        if (cart[index].qty <= 0) {
          cart.splice(index, 1);
        }
        persistAll();
        updateCartBadge();
        renderCart();
      }
      function removeFromCart(index) {
        cart.splice(index, 1);
        persistAll();
        updateCartBadge();
        renderCart();
        showNotify("Dihapus", "Item dihapus dari keranjang.", "info");
      }

      /* ========================= CHECKOUT (ONGKIR) ========================= */
      function openCheckoutModal() {
        if (!currentUser) {
          showNotify(
            "Harap Login",
            "Silakan login terlebih dahulu.",
            "warning",
            [
              {
                label: "Login",
                className: "btn btn-pink",
                onClick: showLoginModal,
              },
            ]
          );
          return;
        }
        document.getElementById("checkoutName").value = currentUser
          ? currentUser.name
          : "";
        document.getElementById("checkoutPhone").value = "";
        document.getElementById("checkoutAddress").value = "";
        document.getElementById("checkoutRequest").value = "";
        document.getElementById("checkoutBox").checked = false;
        document.getElementById("checkoutCard").checked = false;
        document.getElementById("checkoutCandle").checked = false;
        document.getElementById("checkoutGiftBag").checked = false;
        document.getElementById("checkoutCourier").value = "gosend|15000";
        document.getElementById("checkoutPayment").value = "Transfer";
        document.getElementById("checkoutModalFull").classList.add("active");
        document.body.style.overflow = "hidden";
        togglePaymentSections();
        refreshCheckoutTotals();
      }
      function closeCheckoutModal() {
        document.getElementById("checkoutModalFull").classList.remove("active");
        document.body.style.overflow = "auto";
      }

      function calculateShipping(address) {
        // Simulasi perhitungan ongkir berdasarkan alamat
        // Dalam implementasi nyata, ini akan menggunakan API
        if (!address) return 15000; // Default

        const addressLower = address.toLowerCase();

        // Area dengan ongkir lebih murah
        if (
          addressLower.includes("pondok aren") ||
          addressLower.includes("bintaro") ||
          addressLower.includes("serpong") ||
          addressLower.includes("ciputat")
        ) {
          return 15000; // Area dekat
        }
        // Area dengan ongkir sedang
        else if (
          addressLower.includes("jakarta") ||
          addressLower.includes("tangerang") ||
          addressLower.includes("depok")
        ) {
          return 20000; // Area menengah
        }
        // Area dengan ongkir lebih mahal
        else {
          return 25000; // Area jauh
        }
      }

      function refreshCheckoutTotals() {
        const subtotal = cart.reduce(
          (s, i) =>
            s +
            i.price * i.qty +
            (i.box ? 5000 * i.qty : 0) +
            (i.card ? 3000 * i.qty : 0) +
            (i.candle ? 2000 * i.qty : 0) +
            (i.giftBag ? 4000 * i.qty : 0),
          0
        );
        document.getElementById("checkoutSubtotal").textContent =
          "Rp " + subtotal.toLocaleString("id-ID");

        // Calculate shipping based on address
        const address = document.getElementById("checkoutAddress").value;
        let ongkir = calculateShipping(address);

        // Apply selected courier option
        const courierVal = document.getElementById("checkoutCourier").value;
        if (courierVal) {
          const selectedOngkir = parseInt(courierVal.split("|")[1]);
          ongkir = selectedOngkir;
        }

        document.getElementById("checkoutOngkir").textContent =
          "Rp " + ongkir.toLocaleString("id-ID");

        // Calculate additional options from checkout form
        const boxExtra = document.getElementById("checkoutBox").checked
          ? 5000
          : 0;
        const cardExtra = document.getElementById("checkoutCard").checked
          ? 3000
          : 0;
        const candleExtra = document.getElementById("checkoutCandle").checked
          ? 2000
          : 0;
        const giftBagExtra = document.getElementById("checkoutGiftBag").checked
          ? 4000
          : 0;

        const total =
          subtotal + ongkir + boxExtra + cardExtra + candleExtra + giftBagExtra;
        document.getElementById("checkoutTotal").textContent =
          "Rp " + total.toLocaleString("id-ID");
      }

      function submitCheckout() {
        const name = document.getElementById("checkoutName").value.trim();
        const phone = document.getElementById("checkoutPhone").value.trim();
        const addr = document.getElementById("checkoutAddress").value.trim();
        const req = document.getElementById("checkoutRequest").value.trim();
        const boxChecked = document.getElementById("checkoutBox").checked;
        const cardChecked = document.getElementById("checkoutCard").checked;
        const candleChecked = document.getElementById("checkoutCandle").checked;
        const giftBagChecked =
          document.getElementById("checkoutGiftBag").checked;
        const courierVal = document.getElementById("checkoutCourier").value;
        const payment = document.getElementById("checkoutPayment").value;

        if (!name || !phone || !addr) {
          showNotify(
            "Data Kurang",
            "Mohon lengkapi Nama, No Telepon, dan Alamat.",
            "error"
          );
          return;
        }
        if (cart.length === 0) {
          showNotify(
            "Keranjang Kosong",
            "Tidak ada item di keranjang.",
            "warning"
          );
          return;
        }

        const courierParts = courierVal.split("|");
        const courier = courierParts[0];
        const ongkir = parseInt(courierParts[1] || 0);
        const subtotal = cart.reduce(
          (s, i) =>
            s +
            i.price * i.qty +
            (i.box ? 5000 * i.qty : 0) +
            (i.card ? 3000 * i.qty : 0) +
            (i.candle ? 2000 * i.qty : 0) +
            (i.giftBag ? 4000 * i.qty : 0),
          0
        );

        // Calculate additional options from checkout form
        const boxExtra = boxChecked ? 5000 : 0;
        const cardExtra = cardChecked ? 3000 : 0;
        const candleExtra = candleChecked ? 2000 : 0;
        const giftBagExtra = giftBagChecked ? 4000 : 0;

        const total =
          subtotal + ongkir + boxExtra + cardExtra + candleExtra + giftBagExtra;

        const orderId = "ORD" + Date.now();
        const order = {
          id: orderId,
          userEmail: currentUser.email,
          userName: name,
          phone,
          address: addr,
          request: req,
          boxAdded: boxChecked,
          cardAdded: cardChecked,
          candleAdded: candleChecked,
          giftBagAdded: giftBagChecked,
          courier,
          ongkir,
          paymentMethod: payment,
          items: JSON.parse(JSON.stringify(cart)),
          subtotal,
          total,
          createdAt: new Date().toISOString(),
          status: "Menunggu Pembayaran",
          proof: null, // for upload bukti pembayaran (base64)
        };

        orders.push(order);
        cart = [];
        persistAll();
        updateCartBadge();
        renderCart();
        closeCheckoutModal();
        showNotify(
          "Pesanan Dibuat",
          `Pesanan ${
            order.id
          } berhasil dibuat.\nTotal: Rp ${total.toLocaleString(
            "id-ID"
          )}\nSilakan lakukan pembayaran via ${payment}.`,
          "success",
          [
            {
              label: "Lihat Pesanan",
              className: "btn btn-outline",
              onClick: () => {
                scrollToSection("check-orders");
                renderOrders();
              },
            },
          ]
        );
        renderOrders();
        showHome();
        scrollToSection("check-orders");
      }

      /* ========================= ORDERS: check, upload proof, change status ========================= */
      function renderOrders() {
        const container = document.getElementById("ordersContainer");
        container.innerHTML = "";

        if (!currentUser) {
          container.innerHTML =
            "<p style='color:var(--muted);text-align:center'>Silakan login terlebih dahulu untuk melihat pesanan Anda.</p>";
          return;
        }

        // filter hanya pesanan milik user yang login
        const userOrders = orders.filter(
          (o) => o.userEmail === currentUser.email
        );

        if (userOrders.length === 0) {
          container.innerHTML =
            "<p style='color:var(--muted);text-align:center'>Belum ada pesanan untuk akun ini.</p>";
          return;
        }

        userOrders.forEach((order) => {
          const itemsHtml = order.items
            .map(
              (i) =>
                `<li>${i.name} (${i.qty}x) - Rp ${(
                  i.price * i.qty
                ).toLocaleString("id-ID")}</li>`
            )
            .join("");

          const card = document.createElement("div");
          card.className = "order-card";
          card.innerHTML = `
            <h4>Pesanan #${order.id}</h4>
            <ul>${itemsHtml}</ul>
            <p><strong>Total:</strong> Rp ${order.total.toLocaleString(
              "id-ID"
            )}</p>
            <p><strong>Status:</strong> ${order.status}</p>
            <div class="order-actions">
              <button class="btn-ghost" onclick="viewOrderInvoice('${
                order.id
              }')">Detail</button>
              ${
                order.status === "Menunggu Pembayaran" &&
                order.paymentMethod === "Transfer"
                  ? `
                <input type="file" id="proof-${order.id}" accept="image/*" 
                  onchange="uploadProof(event, '${order.id}')" style="display:none">
                <button class="btn-ghost" onclick="document.getElementById('proof-${order.id}').click()">
                  Upload Bukti Bayar
                </button>
              `
                  : ""
              }
              ${
                order.status === "Menunggu Pembayaran" &&
                order.paymentMethod === "QRIS"
                  ? `
                <button class="btn-ghost" onclick="simulatePayment('${order.id}')">
                  Simulasi Bayar QRIS
                </button>
              `
                  : ""
              }
              ${
                order.status !== "Selesai" && order.status !== "Dikirim"
                  ? `
                <button class="btn-ghost" onclick="advanceOrderStatus('${order.id}')">
                  Update Status
                </button>
              `
                  : ""
              }
            </div>
          `;
          container.appendChild(card);
        });
      }

      function viewOrderInvoice(orderId) {
        const o = orders.find((x) => x.id === orderId);
        if (!o)
          return showNotify(
            "Tidak Ditemukan",
            "Pesanan tidak ditemukan",
            "error"
          );
        let itemsHtml = o.items
          .map(
            (it) =>
              `‚Ä¢ ${it.name} (${it.qty}x) ‚Äî Rp ${it.price.toLocaleString(
                "id-ID"
              )}`
          )
          .join("\n");
        const body = `Pesanan: ${o.id}\nNama: ${o.userName}\nAlamat: ${
          o.address
        }\nTelepon: ${o.phone}\nRequest: ${o.request || "-"}\nMetode: ${
          o.paymentMethod
        }\nKurir: ${o.courier}\nStatus: ${
          o.status
        }\n\nItems:\n${itemsHtml}\n\nSubtotal: Rp ${o.subtotal.toLocaleString(
          "id-ID"
        )}\nOngkir: Rp ${o.ongkir.toLocaleString(
          "id-ID"
        )}\nTotal: Rp ${o.total.toLocaleString("id-ID")}`;
        showNotify("Detail Pesanan", body, "info");
      }

      function uploadProof(event, orderId) {
        const file = event.target.files && event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function (e) {
          const b64 = e.target.result;
          const o = orders.find((x) => x.id === orderId);
          if (!o)
            return showNotify(
              "Tidak Ditemukan",
              "Pesanan tidak ditemukan",
              "error"
            );
          o.proof = b64;
          o.status = "Menunggu Konfirmasi";
          persistAll();
          renderOrders();
          showNotify(
            "Bukti Terkirim",
            "Bukti pembayaran telah diupload. Menunggu konfirmasi dari penjual.",
            "success"
          );
        };
        reader.readAsDataURL(file);
      }

      function simulatePayment(orderId) {
        const o = orders.find((x) => x.id === orderId);
        if (!o)
          return showNotify(
            "Tidak Ditemukan",
            "Pesanan tidak ditemukan",
            "error"
          );
        if (o.status === "Menunggu Pembayaran") {
          // set status to Menunggu Konfirmasi (simulasi)
          o.status = "Menunggu Konfirmasi";
          persistAll();
          renderOrders();
          showNotify(
            "Pembayaran Dicatat",
            "Terima kasih, pembayaran dicatat. Menunggu Konfirmasi.",
            "success"
          );
        } else {
          showNotify(
            "Tidak Bisa",
            "Status pesanan tidak bisa diubah pada tahap ini.",
            "warning"
          );
        }
      }

      function advanceOrderStatus(orderId) {
        const o = orders.find((x) => x.id === orderId);
        if (!o)
          return showNotify(
            "Tidak Ditemukan",
            "Pesanan tidak ditemukan",
            "error"
          );

        // Validasi: Pastikan bukti pembayaran sudah diupload untuk pesanan Transfer
        if (
          o.paymentMethod === "Transfer" &&
          o.status === "Menunggu Pembayaran" &&
          !o.proof
        ) {
          showNotify(
            "Bukti Pembayaran Belum Diupload",
            "Harap upload bukti pembayaran terlebih dahulu sebelum melanjutkan proses pesanan.",
            "warning"
          );
          return;
        }

        const steps = [
          "Menunggu Pembayaran",
          "Menunggu Konfirmasi",
          "Diproses",
          "Dikirim",
          "Selesai",
        ];
        const idx = steps.indexOf(o.status);
        if (idx === -1 || idx === steps.length - 1) {
          showNotify("Selesai", "Pesanan sudah di status akhir.", "info");
          return;
        }
        o.status = steps[idx + 1];
        persistAll();
        renderOrders();
        showNotify(
          "Status Diperbarui",
          "Status pesanan " + o.id + " sekarang: " + o.status,
          "success"
        );
      }

      /* ========================= UTIL & EXPOSURE ========================= */
      function persistAllAndRender() {
        persistAll();
        renderOrders();
        renderCart();
        updateCartBadge();
      }

      // expose functions used inline
      window.showLogin = showLoginModal;
      window.showCart = showCart;
      window.showHome = showHome;
      window.scrollToSection = scrollToSection;
      window.openQuickView = openQuickView;
      window.addToCart = addToCart;
      window.filterMenu = function (filter) {
        // Update active tab
        document.querySelectorAll(".tab-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        // Render products based on filter
        renderProducts(filter);
      };
      window.showRandomMessage = function () {
        const message = [
          "Hallaww Moodz! Terimakasih sudah berkunjung di website kami, Jangan Lupa dicheckout yaaaa hihiwwww!",
        ][Math.floor(Math.random() * 5)];
        showNotify("Minz Moodz", message, "info");
      };
      window.updateCartQty = updateCartQty;
      window.removeFromCart = removeFromCart;
      window.checkout = function () {
        document.getElementById("btnProceedCheckout").click();
      };
      window.closeCheckoutModal = closeCheckoutModal;
      window.submitCheckout = submitCheckout;
      window.renderOrders = renderOrders;
      window.advanceOrderStatus = advanceOrderStatus;
      window.simulatePayment = simulatePayment;
      window.viewOrderInvoice = viewOrderInvoice;
      window.logout = logout;
      window.uploadProof = uploadProof;
      window.toggleMobileMenu = toggleMobileMenu;

      // small helper (keep old filter var)
      let currentFilter = "all";

      // persist on unload
      window.addEventListener("beforeunload", persistAll);
    </script>
  </body>
</html>
