<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MoodyCake — Cake Shop</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    /* ---------- (AWAL: CSS LAMA DARI KAMU) ---------- */
    :root{
      --pink-1: #ffeef8;
      --pink-2: #ffb6d5;
      --pink-3: #ff6fa8;
      --accent: #6b2b4a;
      --muted: #6b5b6b;
      --card-shadow: 0 8px 30px rgba(107,43,74,0.12);
      --glass: rgba(255,255,255,0.6);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: linear-gradient(180deg,var(--pink-1), #fff 40%);
      color:var(--accent);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      line-height:1.5;
      overflow-x:hidden;
    }
    header{
      padding:28px 24px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      position:relative;
    }
    .brand{
      display:flex;align-items:center;gap:16px;
    }
    .logo{
      width:64px;
      height:64px;
      border-radius:12px;
      background:white;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:var(--card-shadow);
      flex-shrink:0;
      transition:all 0.3s;
      overflow:hidden;
    }
    .logo img{
      width:100%;
      height:100%;
      object-fit:contain;
      padding:4px;
    }
    .logo:hover{transform:rotate(5deg) scale(1.05)}
    .brand-name{
      font-family:'Playfair Display';
      font-size:24px;
      font-weight:700;
      background:linear-gradient(135deg, var(--pink-3), var(--accent));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
      letter-spacing:1px;
      text-shadow:0 2px 10px rgba(255,111,168,0.2);
    }
    .brand-tagline{
      font-size:11px;
      color:var(--pink-3);
      font-weight:600;
      letter-spacing:2px;
      text-transform:uppercase;
    }
    nav{display:flex;gap:12px;align-items:center}
    nav a{padding:8px 12px;border-radius:999px;text-decoration:none;color:var(--muted);font-weight:600;cursor:pointer;transition:all 0.3s}
    nav a:hover{background:var(--pink-1)}
    
    .cart-btn{
      position:relative;
      background:var(--pink-3);
      color:white;
      border:none;
      padding:10px 16px;
      border-radius:999px;
      cursor:pointer;
      font-weight:600;
      box-shadow:var(--card-shadow);
      display:flex;
      align-items:center;
      gap:8px;
      transition:all 0.3s;
    }
    .cart-btn:hover{transform:scale(1.05)}
    .cart-badge{
      background:var(--accent);
      color:white;
      border-radius:50%;
      width:20px;
      height:20px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:11px;
      font-weight:700;
    }

    /* Floating Cake Character */
    .cake-character{
      position:fixed;
      bottom:30px;
      right:30px;
      width:100px;
      height:100px;
      z-index:999;
      animation: float 3s ease-in-out infinite;
      cursor:pointer;
      transition: transform 0.3s;
    }
    .cake-character:hover{
      transform: scale(1.1) rotate(5deg);
    }
    @keyframes float{
      0%, 100%{transform:translateY(0px)}
      50%{transform:translateY(-15px)}
    }
    .cake-character svg{
      filter: drop-shadow(0 4px 12px rgba(107,43,74,0.3));
    }

    .hero{
      display:grid;grid-template-columns:1fr 520px;gap:24px;padding:24px;
      align-items:center;max-width:1100px;margin:0 auto;
    }
    .hero-left{padding:28px;background:var(--glass);border-radius:18px;box-shadow:var(--card-shadow)}
    .hero h1{font-family:'Playfair Display';font-size:44px;margin:0 0 8px}
    .hero p.lead{margin:0 0 16px;color:var(--muted)}
    .hero .btns{Display:flex;gap:12px}
    .btn{padding:12px 18px;border-radius:12px;border:0;font-weight:700;cursor:pointer;transition:all 0.3s}
    .btn:hover{transform:translateY(-2px);box-shadow:var(--card-shadow)}
    .btn-pink{background:var(--pink-3);color:white}
    .btn-outline{background:transparent;border:2px solid var(--pink-2);color:var(--accent)}

    .card-gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    .card{background:white;border-radius:14px;padding:12px;box-shadow:var(--card-shadow);display:flex;gap:12px;align-items:center;cursor:pointer;transition:all 0.3s}
    .card:hover{transform:translateY(-3px);box-shadow:0 10px 35px rgba(107,43,74,0.15)}
    .card img{width:110px;height:90px;object-fit:cover;border-radius:10px}
    .price{font-weight:800;color:var(--pink-3)}

    /* Menu Tabs */
    .menu-tabs{
      display:flex;
      gap:12px;
      margin:20px 0;
      flex-wrap:wrap;
    }
    .tab-btn{
      padding:10px 20px;
      border-radius:999px;
      border:2px solid var(--pink-2);
      background:white;
      color:var(--accent);
      font-weight:600;
      cursor:pointer;
      transition:all 0.3s;
    }
    .tab-btn:hover{transform:scale(1.05)}
    .tab-btn.active{
      background:var(--pink-3);
      color:white;
      border-color:var(--pink-3);
    }

    .gallery{max-width:1100px;margin:28px auto;padding:24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
    .product{background:white;border-radius:14px;padding:12px;box-shadow:var(--card-shadow);overflow:hidden;transition:transform 0.3s;cursor:pointer}
    .product:hover{transform:translateY(-5px);box-shadow:0 12px 40px rgba(107,43,74,0.18)}
    .product img{width:100%;height:180px;object-fit:cover;border-radius:10px}
    .product .meta{padding:10px}
    .product h3{margin:0 0 6px;font-size:18px}
    .product p{margin:0 0 9px;color:var(--muted);font-size:14px}
    .product .price{font-weight:800}
    .product .actions{display:flex;gap:8px}
    .product .badge{
      display:inline-block;
      padding:4px 10px;
      border-radius:12px;
      font-size:11px;
      font-weight:700;
      margin-bottom:8px;
    }
    .badge-featured{background:#ffd700;color:#6b2b4a}
    .badge-new{background:#4ecdc4;color:white}
    .badge-popular{background:#ff6b6b;color:white}

    /* Modal */
    .modal{
      display:none;
      position:fixed;
      top:0;left:0;right:0;bottom:0;
      background:rgba(0,0,0,0.6);
      z-index:1000;
      align-items:center;
      justify-content:center;
      padding:20px;
    }
    .modal.active{display:flex}
    .modal-content{
      background:white;
      border-radius:18px;
      max-width:600px;
      width:100%;
      max-height:90vh;
      overflow-y:auto;
      box-shadow:0 20px 60px rgba(0,0,0,0.3);
      animation: slideUp 0.3s ease;
    }
    @keyframes slideUp{
      from{transform:translateY(30px);opacity:0}
      to{transform:translateY(0);opacity:1}
    }
    .modal-header{
      padding:20px;
      border-bottom:1px solid #f0f0f0;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .modal-body{padding:20px}
    .modal-body img{width:100%;border-radius:12px;margin-bottom:16px}
    .close-btn{
      background:transparent;
      border:none;
      font-size:28px;
      cursor:pointer;
      color:var(--muted);
      line-height:1;
      transition:all 0.3s;
    }
    .close-btn:hover{color:var(--pink-3);transform:rotate(90deg)}
    .quantity-control{
      display:flex;
      align-items:center;
      gap:12px;
      margin:16px 0;
    }
    .qty-btn{
      width:36px;
      height:36px;
      border-radius:8px;
      border:2px solid var(--pink-2);
      background:white;
      cursor:pointer;
      font-weight:700;
      color:var(--accent);
      transition:all 0.3s;
    }
    .qty-btn:hover{background:var(--pink-1);transform:scale(1.1)}
    .qty-display{
      font-size:18px;
      font-weight:700;
      min-width:40px;
      text-align:center;
    }

    /* Cart Page */
    .cart-page{
      display:none;
      max-width:900px;
      margin:40px auto;
      padding:24px;
    }
    .cart-page.active{display:block}
    .cart-item{
      background:white;
      border-radius:14px;
      padding:16px;
      margin-bottom:12px;
      display:flex;
      gap:16px;
      align-items:center;
      box-shadow:var(--card-shadow);
    }
    .cart-item img{
      width:100px;
      height:80px;
      object-fit:cover;
      border-radius:10px;
    }
    .cart-item-info{flex:1}
    .cart-item-actions{
      display:flex;
      gap:8px;
      align-items:center;
    }
    .remove-btn{
      background:#ff4444;
      color:white;
      border:none;
      padding:8px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:600;
      transition:all 0.3s;
    }
    .remove-btn:hover{background:#cc0000;transform:scale(1.05)}
    .cart-summary{
      background:var(--glass);
      border-radius:14px;
      padding:20px;
      margin-top:20px;
      box-shadow:var(--card-shadow);
    }
    .empty-cart{
      text-align:center;
      padding:60px 20px;
      color:var(--muted);
    }

    /* Map Section */
    .map-section{
      max-width:1100px;
      margin:40px auto;
      padding:24px;
      background:var(--glass);
      border-radius:18px;
      box-shadow:var(--card-shadow);
    }
    .map-container{
      width:100%;
      height:400px;
      border-radius:14px;
      overflow:hidden;
      margin-top:16px;
      box-shadow:var(--card-shadow);
    }
    .map-container iframe{
      width:100%;
      height:100%;
      border:none;
    }
    .contact-info{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));
      gap:20px;
      margin-top:24px;
    }
    .contact-card{
      background:white;
      padding:20px;
      border-radius:12px;
      box-shadow:var(--card-shadow);
      display:flex;
      align-items:center;
      gap:16px;
      transition:all 0.3s;
    }
    .contact-card:hover{
      transform:translateY(-5px);
      box-shadow:0 12px 40px rgba(107,43,74,0.18);
    }
    .contact-icon{
      font-size:32px;
      flex-shrink:0;
      animation: bounce 2s ease-in-out infinite;
    }
    @keyframes bounce{
      0%, 100%{transform:translateY(0)}
      50%{transform:translateY(-5px)}
    }
    .contact-details h4{
      margin:0 0 4px;
      font-size:14px;
      color:var(--muted);
      font-weight:600;
    }
    .contact-details p{
      margin:0;
      font-weight:600;
      color:var(--accent);
    }

    /* Testimonial Section */
    .testimonial-section{
      max-width:1100px;
      margin:40px auto;
      padding:24px;
    }
    .testimonial-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(300px, 1fr));
      gap:20px;
      margin-top:24px;
    }
    .testimonial-card{
      background:rgb(255, 188, 216);
      padding:24px;
      border-radius:14px;
      box-shadow:var(--card-shadow);
      transition:all 0.3s;
      position:relative;
      overflow:hidden;
    }
    .testimonial-card::before{
      content:'❝';
      position:absolute;
      top:-10px;
      left:10px;
      font-size:80px;
      color:var(--pink-2);
      opacity:0.3;
      font-family:'Playfair Display';
    }
    .testimonial-card:hover{
      transform:translateY(-8px) scale(1.02);
      box-shadow:0 15px 50px rgba(21, 8, 14, 0.2);
    }
    .testimonial-header{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:16px;
      position:relative;
      z-index:1;
    }
    .testimonial-avatar{
      width:50px;
      height:50px;
      border-radius:50%;
      background:linear-gradient(135deg, var(--pink-3), var(--pink-2));
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:24px;
      flex-shrink:0;
    }
    .testimonial-info h4{
      margin:0 0 4px;
      font-weight:700;
      color:var(--accent);
    }
    .testimonial-info p{
      margin:0;
      font-size:13px;
      color:var(--muted);
    }
    .testimonial-stars{
      color:#ffd700;
      font-size:16px;
      letter-spacing:2px;
    }
    .testimonial-text{
      color:var(--muted);
      line-height:1.6;
      font-style:italic;
      position:relative;
      z-index:1;
    }

    /* Animated Stats */
    .stats-section{
      max-width:1100px;
      margin:40px auto;
      padding:24px;
      background:linear-gradient(135deg, var(--pink-3), var(--accent));
      border-radius:18px;
      box-shadow:var(--card-shadow);
    }
    .stats-grid{
      display:grid;
      grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
      gap:24px;
    }
    .stat-item{
      text-align:center;
      padding:20px;
      background:rgba(255,255,255,0.15);
      border-radius:12px;
      backdrop-filter:blur(10px);
      transition:all 0.3s;
    }
    .stat-item:hover{
      background:rgba(255,255,255,0.25);
      transform:scale(1.05);
    }
    .stat-number{
      font-size:42px;
      font-weight:700;
      color:white;
      font-family:'Playfair Display';
      margin-bottom:8px;
    }
    .stat-label{
      color:white;
      font-size:14px;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:1px;
    }

    footer{padding:28px;text-align:center;color:var(--muted)}

    /* Mobile Menu */
    .mobile-menu-btn{
      display:none;
      background:transparent;
      border:none;
      font-size:28px;
      cursor:pointer;
      color:var(--accent);
    }
    .mobile-nav{
      display:none;
      position:fixed;
      top:0;
      right:-100%;
      width:280px;
      height:100vh;
      background:white;
      box-shadow:-5px 0 20px rgba(0,0,0,0.1);
      padding:80px 20px 20px;
      transition:right 0.3s;
      z-index:1001;
    }
    .mobile-nav.active{
      right:0;
    }
    .mobile-nav a, .mobile-nav button{
      display:block;
      width:100%;
      padding:16px;
      margin-bottom:8px;
      text-align:left;
      border-radius:12px;
      border:none;
      background:white;
      color:var(--accent);
      font-weight:600;
      cursor:pointer;
      transition:all 0.3s;
    }
    .mobile-nav a:hover, .mobile-nav button:hover{
      background:var(--pink-1);
    }
    .mobile-nav .cart-btn{
      background:var(--pink-3);
      color:white;
      justify-content:center;
    }
    .close-mobile-menu{
      position:absolute;
      top:20px;
      right:20px;
      background:transparent;
      border:none;
      font-size:32px;
      cursor:pointer;
      color:var(--muted);
    }
    .mobile-overlay{
      display:none;
      position:fixed;
      top:0;
      left:0;
      right:0;
      bottom:0;
      background:rgba(0,0,0,0.5);
      z-index:1000;
    }
    .mobile-overlay.active{
      display:block;
    }

    @media (max-width:900px){
      .hero{grid-template-columns:1fr;gap:16px}
      .hero-left,.hero-right{width:100%}
      .hero h1{font-size:32px}
      .hero-left{padding:20px}
      nav{display:none}
      .mobile-menu-btn{display:block}
      .mobile-nav{display:block}
      .cake-character{width:70px;height:70px;bottom:20px;right:20px}
      .card-gallery{grid-template-columns:1fr}
      .gallery{grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px}
      .product img{height:140px}
      .brand-name{font-size:20px}
      .brand-tagline{font-size:9px}
      .cart-item{flex-direction:column;align-items:flex-start}
      .cart-item img{width:100%;height:150px}
      .cart-item-actions{width:100%;justify-content:space-between}
      .map-container{height:300px}
      .contact-info{grid-template-columns:1fr}
      .testimonial-grid{grid-template-columns:1fr}
      .stats-grid{grid-template-columns:repeat(2, 1fr)}
    }

    @media (max-width:600px){
      header{padding:20px 16px}
      .hero{padding:16px}
      .hero h1{font-size:28px}
      .hero .btns{flex-direction:column}
      .btn{width:100%}
      .logo{width:56px;height:56px}
      .logo img{padding:2px}
      .brand-name{font-size:18px}
      .menu-tabs{gap:8px}
      .tab-btn{padding:8px 16px;font-size:14px}
      section{padding:16px!important}
      .gallery{padding:16px}
      .modal-content{margin:10px;max-width:calc(100% - 20px)}
      .cart-btn{padding:8px 12px;font-size:14px}
      .map-section{padding:16px}
      .map-container{height:250px}
      .contact-card{flex-direction:column;text-align:center}
      .stats-grid{grid-template-columns:1fr}
      .stat-number{font-size:32px}
    }

    /* ---------- (TAMBAHAN CSS UNTUK LOGIN/CHECKOUT/ORDER) ---------- */
    /* kecilkan modal forms baru agar pas dengan design */
    .small-form .modal-content{max-width:420px}
    .form-row{display:flex;gap:10px}
    .form-row .col{flex:1}
    .order-list{max-width:1100px;margin:20px auto}
    .order-card{background:white;padding:12px;border-radius:12px;box-shadow:var(--card-shadow);margin-bottom:12px}
    .order-actions{display:flex;gap:8px;align-items:center}
    .btn-ghost{background:transparent;border:2px solid var(--pink-2);color:var(--accent);padding:8px 12px;border-radius:8px}
  </style>
</head>
<body>
  <!-- Floating Cake Character -->
  <div class="cake-character" onclick="showRandomMessage()" title="Klik aku!">
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <ellipse cx="50" cy="85" rx="35" ry="8" fill="#ffb6d5"/>
      <rect x="15" y="60" width="70" height="25" rx="5" fill="#ff6fa8"/>
      <rect x="15" y="60" width="70" height="8" rx="3" fill="#ffd1e5"/>
      <rect x="20" y="40" width="60" height="20" rx="5" fill="#ffb6d5"/>
      <rect x="20" y="40" width="60" height="6" rx="3" fill="#ffe0f0"/>
      <rect x="25" y="25" width="50" height="15" rx="5" fill="#ff6fa8"/>
      <rect x="25" y="25" width="50" height="5" rx="3" fill="#ffd1e5"/>
      <circle cx="50" cy="20" r="6" fill="#ff4757"/>
      <circle cx="50" cy="20" r="4" fill="#ff6b7a"/>
      <ellipse cx="48" cy="18" rx="2" ry="1.5" fill="#ff9aa2" opacity="0.7"/>
      <circle cx="30" cy="50" r="2" fill="#fff"/>
      <circle cx="45" cy="52" r="2" fill="#fff"/>
      <circle cx="60" cy="48" r="2" fill="#fff"/>
      <circle cx="35" cy="70" r="2" fill="#fff"/>
      <circle cx="50" cy="72" r="2" fill="#fff"/>
      <circle cx="65" cy="68" r="2" fill="#fff"/>
      <rect x="47" y="10" width="6" height="12" rx="1" fill="#ffd93d"/>
      <ellipse cx="50" cy="8" rx="4" ry="3" fill="#ff6348"/>
      <ellipse cx="50" cy="6" rx="3" ry="2" fill="#ff8c7a" opacity="0.8"/>
    </svg>
  </div>

  <header>
    <div class="brand">
      <div class="logo">
        <img src="logoy.png" alt="MoodyCake Logo">
      </div>
      <div>
        <div class="brand-name">MoodyCake</div>
        <div class="brand-tagline">✨ Made with Love ✨</div>
      </div>
    </div>
    <nav>
      <a onclick="showHome()">Home</a>
      <a onclick="scrollToSection('menu')">Menu</a>
      <a onclick="scrollToSection('testimonials')">Testimoni</a>
      <a onclick="scrollToSection('about')">About</a>
      <a onclick="scrollToSection('check-orders')">Check Pesanan</a>
      <button class="cart-btn" onclick="showCart()">
        🛒 Keranjang
        <span class="cart-badge" id="cartBadge">0</span>
      </button>
    </nav>
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()">☰</button>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-overlay" id="mobileOverlay" onclick="toggleMobileMenu()"></div>
  <div class="mobile-nav" id="mobileNav">
    <button class="close-mobile-menu" onclick="toggleMobileMenu()">×</button>
    <a onclick="showHome(); toggleMobileMenu()">🏠 Home</a>
    <a onclick="scrollToSection('menu'); toggleMobileMenu()">🍰 Menu</a>
    <a onclick="scrollToSection('testimonials'); toggleMobileMenu()">💬 Testimoni</a>
    <a onclick="scrollToSection('about'); toggleMobileMenu()">ℹ About</a>
    <a onclick="scrollToSection('check-orders'); toggleMobileMenu()">📦 Check Pesanan</a>
    <button class="cart-btn" onclick="showCart(); toggleMobileMenu()">
      🛒 Keranjang
      <span class="cart-badge" id="cartBadgeMobile">0</span>
    </button>
  </div>

  <main id="mainContent">
    <section class="hero">
      <div class="hero-left">
        <h1>MoodyCake — Kue Cantik & Lezat</h1>
        <p class="lead">Koleksi bento cake, custom design, dan kue ulang tahun. Rasa yang menyentuh hati.</p>
        <div class="btns">
          <button class="btn btn-pink" onclick="scrollToSection('menu')">Lihat Menu</button>
          <button class="btn btn-outline" onclick="showCart()">Lihat Keranjang</button>
        </div>

        <div style="margin-top:18px" class="card-gallery">
          <div class="card" onclick="openQuickView(1)">
            <img src="https://images.unsplash.com/photo-1535254973040-607b474cb50d?auto=format&fit=crop&w=300&q=60" alt="Rose Pink Delight">
            <div>
              <div style="font-weight:700">Rose Pink Delight</div>
              <div style="font-size:13px;color:var(--muted)">Buttercream dengan bunga mawar</div>
              <div class="price">Rp 180.000</div>
            </div>
          </div>

          <div class="card" onclick="openQuickView(2)">
            <img src="https://images.unsplash.com/photo-1559628233-efb10f6a5f13?auto=format&fit=crop&w=300&q=60" alt="Mini Cupcakes">
            <div>
              <div style="font-weight:700">Mini Cupcakes (6)</div>
              <div style="font-size:13px;color:var(--muted)">Vanilla, Cokelat, Red Velvet</div>
              <div class="price">Rp 85.000</div>
            </div>
          </div>
        </div>
      </div>

      <div class="hero-right">
        <img src="https://images.unsplash.com/photo-1558636508-e0db3814bd1d?auto=format&fit=crop&w=800&q=60" alt="Featured Cake" style="width:100%;border-radius:18px;box-shadow:var(--card-shadow)">
      </div>
    </section>

    <section id="menu" style="max-width:1100px;margin:0 auto;padding:0 24px">
      <h2 style="font-family:'Playfair Display';font-size:28px">Menu Kami</h2>
      <p style="color:var(--muted);margin-top:6px">Jelajahi koleksi kue terbaik kami.</p>

      <div class="menu-tabs">
        <button class="tab-btn active" onclick="filterMenu('featured')">⭐ Menu Pilihan</button>
        <button class="tab-btn" onclick="filterMenu('all')">🍰 Semua Menu</button>
      </div>

      <div class="gallery" id="gallery"></div>
    </section>

    <section id="about" style="max-width:1100px;margin:40px auto;padding:24px;background:var(--glass);border-radius:18px;box-shadow:var(--card-shadow)">
      <h2 style="font-family:'Playfair Display';font-size:28px;margin-top:0">Tentang MoodyCake</h2>
      <p style="color:var(--muted);line-height:1.8">
        MoodyCake adalah cake shop yang berdedikasi untuk menghadirkan kue-kue berkualitas dengan desain cantik dan rasa yang memanjakan lidah. 
        Setiap kue dibuat dengan penuh cinta dan perhatian terhadap detail, menggunakan bahan-bahan premium pilihan.
      </p>
      <p style="color:var(--muted);line-height:1.8">
        Kami melayani custom design untuk berbagai acara spesial Anda. Mari wujudkan kue impian Anda bersama MoodyCake! 🎂💕
      </p>
    </section>

    <!-- Testimonial Section -->
    <section class="testimonial-section" id="testimonials">
      <h2 style="font-family:'Playfair Display';font-size:28px;text-align:center">💬 Testimoni Pelanggan</h2>
      <p style="color:var(--muted);text-align:center;margin-top:6px">Apa kata mereka tentang MoodyCake?</p>
      
      <div class="testimonial-grid">
        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👩</div>
            <div class="testimonial-info">
              <h4>Sarah Wijaya</h4>
              <p>Jakarta Selatan</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Kue ulang tahun custom untuk anak saya luar biasa! Desainnya persis seperti yang diminta dan rasanya enak banget. Semua tamu pujian terus!"
          </p>
        </div>

        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👨</div>
            <div class="testimonial-info">
              <h4>Budi Santoso</h4>
              <p>Tangerang</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Bento cake-nya cute dan enak! Cocok banget buat kado. Harganya juga affordable. Pasti bakal order lagi!"
          </p>
        </div>

        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👩</div>
            <div class="testimonial-info">
              <h4>Putri Amelia</h4>
              <p>Pondok Aren</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Layanan ramah dan cepat! Kuenya selalu fresh dan packaging-nya rapi. MoodyCake is the best! 💕"
          </p>
        </div>

        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👨</div>
            <div class="testimonial-info">
              <h4>Andi Pratama</h4>
              <p>Bintaro</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Rose Pink Delight-nya cantik banget! Istri saya suka sekali. Tekstur cake-nya lembut dan tidak terlalu manis."
          </p>
        </div>

        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👩</div>
            <div class="testimonial-info">
              <h4>Rina Susanti</h4>
              <p>Serpong</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Sudah 3x order untuk acara kantor. Cupcakes-nya selalu jadi favorit! Pelayanannya juga oke banget."
          </p>
        </div>

        <div class="testimonial-card">
          <div class="testimonial-header">
            <div class="testimonial-avatar">👨</div>
            <div class="testimonial-info">
              <h4>Dimas Rizky</h4>
              <p>Ciputat</p>
            </div>
          </div>
          <div class="testimonial-stars">★★★★★</div>
          <p class="testimonial-text">
            "Kualitas premium dengan harga yang reasonable. Delivery-nya juga tepat waktu. Highly recommended!"
          </p>
        </div>
      </div>
    </section>

    <section class="map-section" id="location">
      <h2 style="font-family:'Playfair Display';font-size:28px;margin-top:0">📍 Lokasi & Kontak Kami</h2>
      <p style="color:var(--muted)">Kunjungi toko kami atau hubungi untuk pemesanan</p>
      
      <div class="contact-info">
        <div class="contact-card">
          <div class="contact-icon">📍</div>
          <div class="contact-details">
            <h4>ALAMAT</h4>
            <p>Jl. H. Paten, Pondok Karya<br>Pondok Aren, Tangerang Selatan</p>
          </div>
        </div>
        <div class="contact-card">
          <div class="contact-icon">📞</div>
          <div class="contact-details">
            <h4>TELEPON</h4>
            <p>+62 812-3456-7890</p>
          </div>
        </div>
        <div class="contact-card">
          <div class="contact-icon">🕒</div>
          <div class="contact-details">
            <h4>JAM BUKA</h4>
            <p>Senin - Sabtu: 08:00 - 20:00<br>Minggu: 09:00 - 18:00</p>
          </div>
        </div>
      </div>

      <div class="map-container">
        <iframe 
          src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3965.3314520304044!2d106.73823631476945!3d-6.346234195407943!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x2e69e579c5f0e74b%3A0x5e8e897f8f1e8b7a!2sJl.%20H.%20Paten%2C%20Pondok%20Karya%2C%20Kec.%20Pd.%20Aren%2C%20Kota%20Tangerang%20Selatan%2C%20Banten!5e0!3m2!1sen!2sid!4v1234567890" 
          allowfullscreen="" 
          loading="lazy" 
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>
    </section>

    <!-- Check Orders Section -->
    <section id="check-orders" style="max-width:1100px;margin:40px auto;padding:24px;">
      <h2 style="font-family:'Playfair Display';font-size:28px;margin-top:0">📦 Check Pesanan Anda</h2>
      <p style="color:var(--muted)">Di sini Anda bisa melihat status pesanan. (Untuk demo ada tombol update status.)</p>
      <div id="ordersContainer" class="order-list"></div>
    </section>
  </main>

  <!-- Cart Page (existing in your layout) -->
  <div class="cart-page" id="cartPage">
    <h2 style="font-family:'Playfair Display';font-size:32px;margin-bottom:20px">🛒 Keranjang Belanja</h2>
    <div id="cartItems"></div>
    <div class="cart-summary" id="cartSummary" style="display:none">
      <h3 style="margin-top:0">Ringkasan Pesanan</h3>
      <div style="display:flex;justify-content:space-between;margin:12px 0">
        <span>Total Item:</span>
        <strong id="totalItems">0</strong>
      </div>
      <div style="display:flex;justify-content:space-between;margin:12px 0;font-size:20px">
        <strong>Total Harga:</strong>
        <strong style="color:var(--pink-3)" id="totalPrice">Rp 0</strong>
      </div>
      <button class="btn btn-pink" style="width:100%;margin-top:16px" id="btnProceedCheckout">Checkout</button>
      <button class="btn btn-outline" style="width:100%;margin-top:8px" onclick="showHome()">Lanjut Belanja</button>
    </div>
  </div>

  <!-- Modal: Product Quick View (lama) -->
  <div class="modal" id="productModal" onclick="closeModalOnBackdrop(event)">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="modalTitle" style="margin:0;font-family:'Playfair Display'"></h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <div class="modal-body">
        <img id="modalImage" src="" alt="">
        <div id="modalBadge"></div>
        <p id="modalDescription" style="color:var(--muted);margin-bottom:12px"></p>
        <div class="price" id="modalPrice" style="font-size:24px"></div>
        
        <div class="quantity-control">
          <button class="qty-btn" onclick="decreaseQty()">−</button>
          <span class="qty-display" id="qtyDisplay">1</span>
          <button class="qty-btn" onclick="increaseQty()">+</button>
        </div>

        <button class="btn btn-pink" style="width:100%" id="modalAddToCartBtn">🛒 Tambah ke Keranjang</button>
      </div>
    </div>
  </div>

  <!-- Modal: LOGIN -->
  <div class="modal" id="loginModalSmall">
    <div class="modal-content small-form">
      <div style="display:flex;justify-content:space-between;align-items:center;padding-bottom:8px">
        <h3 style="margin:0">Login</h3>
        <button class="close-btn" onclick="closeAuthModals()">&times;</button>
      </div>
      <div style="padding:8px 0 20px">
        <input id="loginEmail" type="email" placeholder="Email" style="padding:10px;width:100%;margin-bottom:8px;border-radius:8px;border:1px solid #eee">
        <input id="loginPassword" type="password" placeholder="Password" style="padding:10px;width:100%;margin-bottom:8px;border-radius:8px;border:1px solid #eee">
        <div style="display:flex;gap:8px">
          <button class="btn btn-pink" onclick="handleLogin()">Login</button>
          <button class="btn-ghost" onclick="showRegisterModal()">Daftar</button>
        </div>
        <p style="color:var(--muted);font-size:13px;margin-top:10px">Untuk demo akun disimpan lokal (tidak aman untuk production).</p>
      </div>
    </div>
  </div>

  <!-- Modal: REGISTER -->
  <div class="modal" id="registerModalSmall">
    <div class="modal-content small-form">
      <div style="display:flex;justify-content:space-between;align-items:center;padding-bottom:8px">
        <h3 style="margin:0">Daftar Akun</h3>
        <button class="close-btn" onclick="closeAuthModals()">&times;</button>
      </div>
      <div style="padding:8px 0 20px">
        <input id="regName" type="text" placeholder="Nama Lengkap" style="padding:10px;width:100%;margin-bottom:8px;border-radius:8px;border:1px solid #eee">
        <input id="regEmail" type="email" placeholder="Email" style="padding:10px;width:100%;margin-bottom:8px;border-radius:8px;border:1px solid #eee">
        <input id="regPassword" type="password" placeholder="Password" style="padding:10px;width:100%;margin-bottom:8px;border-radius:8px;border:1px solid #eee">
        <div style="display:flex;gap:8px">
          <button class="btn btn-pink" onclick="handleRegister()">Daftar</button>
          <button class="btn-ghost" onclick="showLoginModal()">Login</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: CHECKOUT FORM -->
  <div class="modal" id="checkoutModalFull" onclick="closeModalOnBackdrop(event)">
    <div class="modal-content">
      <div class="modal-header">
        <h3 style="margin:0">Form Checkout</h3>
        <button class="close-btn" onclick="closeCheckoutModal()">&times;</button>
      </div>
      <div class="modal-body">
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <input id="checkoutName" placeholder="Nama Penerima" style="padding:10px;border-radius:8px;border:1px solid #eee;width:100%;margin-bottom:8px">
          <input id="checkoutPhone" placeholder="No Telepon" style="padding:10px;border-radius:8px;border:1px solid #eee;width:100%;margin-bottom:8px">
          <textarea id="checkoutAddress" placeholder="Alamat lengkap" style="padding:10px;border-radius:8px;border:1px solid #eee;width:100%;margin-bottom:8px"></textarea>
          <textarea id="checkoutRequest" placeholder="Request Desain (opsional)" style="padding:10px;border-radius:8px;border:1px solid #eee;width:100%;margin-bottom:8px"></textarea>
          <label style="display:flex;align-items:center;gap:8px"><input id="checkoutBox" type="checkbox"> Tambah Box Coklat (+Rp 5.000)</label>
          <div style="margin-top:8px">
            <label style="display:block;margin-bottom:6px;font-weight:700">Metode Pembayaran</label>
            <select id="checkoutPayment" style="padding:10px;border-radius:8px;border:1px solid #eee;width:100%">
              <option value="Transfer">Transfer Bank</option>
              <option value="QRIS">QRIS</option>
            </select>
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:12px">
          <button class="btn btn-pink" onclick="submitCheckout()">Kirim & Buat Pesanan</button>
          <button class="btn-ghost" onclick="closeCheckoutModal()">Batal</button>
        </div>
        <p style="color:var(--muted);margin-top:10px;font-size:13px">Setelah membuat pesanan, status awal akan <strong>Menunggu Pembayaran</strong>. Kamu bisa lihat status di menu Check Pesanan.</p>
      </div>
    </div>
  </div>

  <footer>
    <p><strong>MoodyCake</strong> &mdash; Cake shop kecil dengan sentuhan pink. Follow kami di Instagram: <em>@moodycake.id</em></p>
    <small>© MoodyCake 2025</small>
  </footer>

  <!-- ================== SCRIPT UTAMA (gabungan fitur lama + baru) ================== -->
  <script>
    /* ---------- DATA PRODUK (SAMA DENGAN LAMA) ---------- */
    const products = [
      {
        id: 1,
        name: 'Rose Pink Delight',
        description: 'Kue buttercream dihias bunga mawar edible yang cantik dan elegan.',
        price: 180000,
        image: 'https://images.unsplash.com/photo-1535254973040-607b474cb50d?auto=format&fit=crop&w=800&q=60',
        featured: true,
        badge: 'featured'
      },
      {
        id: 2,
        name: 'Mini Cupcakes (6)',
        description: 'Pilihan rasa: vanilla, cokelat, red velvet. Sempurna untuk acara kecil.',
        price: 85000,
        image: 'https://images.unsplash.com/photo-1559628233-efb10f6a5f13?auto=format&fit=crop&w=800&q=60',
        featured: true,
        badge: 'popular'
      },
      {
        id: 3,
        name: 'Moody Layers',
        description: 'Kue lapis lembut dengan pilihan buah segar. Tekstur yang memanjakan.',
        price: 150000,
        image: 'https://images.unsplash.com/photo-1512621776951-a57141f2eefd?auto=format&fit=crop&w=800&q=60',
        featured: false,
        badge: 'new'
      },
      {
        id: 4,
        name: 'Custom Birthday Cake',
        description: 'Desain custom sesuai permintaan. Hubungi untuk konsultasi desain Anda.',
        price: 200000,
        image: 'https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=800&q=60',
        featured: false,
        badge: 'featured'
      }
    ];

    /* ---------- STATE (users / session / cart / orders) ---------- */
    let users = JSON.parse(localStorage.getItem('mc_users') || '[]'); // [{name,email,pass}]
    let currentUser = JSON.parse(localStorage.getItem('mc_currentUser') || 'null'); // {name,email}
    let cart = JSON.parse(localStorage.getItem('mc_cart') || '[]'); // [{id, name, price, qty, box}]
    let orders = JSON.parse(localStorage.getItem('mc_orders') || '[]'); // [{id, userEmail, info..., status, items, payment}]

    /* ---------- HELPER: persist -> localStorage ---------- */
    function persistAll(){
      localStorage.setItem('mc_users', JSON.stringify(users));
      localStorage.setItem('mc_currentUser', JSON.stringify(currentUser));
      localStorage.setItem('mc_cart', JSON.stringify(cart));
      localStorage.setItem('mc_orders', JSON.stringify(orders));
    }

    /* ---------- UI INIT ---------- */
    document.addEventListener('DOMContentLoaded', () => {
      renderProducts();
      updateCartBadge();
      renderCart(); // in case persisted items exist
      renderOrders(); // show orders in check-orders
      // hook add to cart button in modal
      document.getElementById('modalAddToCartBtn').addEventListener('click', () => {
        // use currentProductFromModal
        addToCartFromModal();
      });
      // proceed checkout button in cart summary
      document.getElementById('btnProceedCheckout').addEventListener('click', () => {
        if(cart.length === 0){ alert('Keranjang kosong.'); return; }
        openCheckoutModal();
      });
    });

    /* ---------- ORIGINAL INTERACTIONS (dari codingan lama) ---------- */
    function toggleMobileMenu(){
      const mobileNav = document.getElementById('mobileNav');
      const mobileOverlay = document.getElementById('mobileOverlay');
      mobileNav.classList.toggle('active');
      mobileOverlay.classList.toggle('active');
    }

    const cakeMessages = [
      "Hai! Aku cake character MoodyCake! 🎂",
      "Kue kami dibuat dengan cinta! 💕",
      "Sudah coba menu pilihan kami? 😋",
      "Jangan lupa pesan kue favoritmu! 🍰",
      "Setiap kue istimewa seperti kamu! ✨"
    ];

    function showRandomMessage(){
      const message = cakeMessages[Math.floor(Math.random() * cakeMessages.length)];
      alert(message);
    }

    function scrollToSection(id){
      const el = document.getElementById(id);
      if(el) el.scrollIntoView({behavior:'smooth',block:'start'});
    }

    function showHome(){
      document.getElementById('mainContent').style.display = 'block';
      document.getElementById('cartPage').classList.remove('active');
      window.scrollTo(0, 0);
    }

    /* ---------- RENDER PRODUK (gabungan perbaikan template literal) ---------- */
    let currentFilter = 'featured';
    function filterMenu(filter){
      currentFilter = filter;
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(btn => {
        if((filter === 'featured' && btn.textContent.includes('Pilihan')) ||
           (filter === 'all' && btn.textContent.includes('Semua'))){
          btn.classList.add('active');
        }
      });
      renderProducts();
    }

    function renderProducts(){
      const gallery = document.getElementById('gallery');
      const filtered = currentFilter === 'featured' 
        ? products.filter(p => p.featured)
        : products;

      gallery.innerHTML = filtered.map(p => {
        const badgeLabel = p.badge ? (p.badge === 'featured' ? '⭐ Pilihan' : p.badge === 'popular' ? '🔥 Populer' : '✨ Baru') : '';
        return `
          <article class="product" onclick="openQuickView(${p.id})">
            <img src="${p.image}" alt="${p.name}">
            <div class="meta">
              ${p.badge ? `<span class="badge badge-${p.badge}">${badgeLabel}</span>` : ''}
              <h3>${p.name}</h3>
              <p>${p.description}</p>
              <div class="price">Rp ${p.price.toLocaleString('id-ID')}</div>
            </div>
          </article>
        `;
      }).join('');
    }

    /* ---------- PRODUCT QUICK VIEW (lama) ---------- */
    let currentProductFromModal = null;
    let currentQty = 1;

    function openQuickView(productId){
      currentProductFromModal = products.find(p => p.id === productId);
      if(!currentProductFromModal) return;
      
      currentQty = 1;
      
      document.getElementById('modalTitle').textContent = currentProductFromModal.name;
      document.getElementById('modalImage').src = currentProductFromModal.image;
      document.getElementById('modalDescription').textContent = currentProductFromModal.description;
      document.getElementById('modalPrice').textContent = 'Rp ' + currentProductFromModal.price.toLocaleString('id-ID');
      document.getElementById('qtyDisplay').textContent = currentQty;
      
      const badgeHtml = currentProductFromModal.badge 
        ? `<span class="badge badge-${currentProductFromModal.badge}" style="margin-bottom:12px">${
            currentProductFromModal.badge === 'featured' ? '⭐ Pilihan' : 
            currentProductFromModal.badge === 'popular' ? '🔥 Populer' : 
            '✨ Baru'
          }</span>`
        : '';
      document.getElementById('modalBadge').innerHTML = badgeHtml;
      
      document.getElementById('productModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeModal(){
      document.getElementById('productModal').classList.remove('active');
      document.body.style.overflow = 'auto';
    }

    function closeModalOnBackdrop(event){
      if(event.target.id === 'productModal' || event.target.id === 'checkoutModalFull'){
        closeModal();
      }
    }

    function increaseQty(){
      currentQty++;
      document.getElementById('qtyDisplay').textContent = currentQty;
    }

    function decreaseQty(){
      if(currentQty > 1){
        currentQty--;
        document.getElementById('qtyDisplay').textContent = currentQty;
      }
    }

    /* ---------- NEW: AUTH (register/login/logout) ---------- */
    function showLoginModal(){
      document.getElementById('loginModalSmall').classList.add('active');
    }
    function showRegisterModal(){
      document.getElementById('registerModalSmall').classList.add('active');
    }
    function closeAuthModals(){
      document.getElementById('loginModalSmall').classList.remove('active');
      document.getElementById('registerModalSmall').classList.remove('active');
    }

    function handleRegister(){
      const name = document.getElementById('regName').value.trim();
      const email = document.getElementById('regEmail').value.trim().toLowerCase();
      const pass = document.getElementById('regPassword').value;
      if(!name || !email || !pass){ alert('Lengkapi semua data.'); return; }
      if(users.find(u=>u.email === email)){ alert('Email sudah terdaftar. Silakan login.'); showLoginModal(); return; }
      users.push({name, email, pass});
      persistAll();
      alert('Registrasi berhasil. Silakan login.');
      closeAuthModals();
      showLoginModal();
    }

    function handleLogin(){
      const email = document.getElementById('loginEmail').value.trim().toLowerCase();
      const pass = document.getElementById('loginPassword').value;
      const u = users.find(x => x.email === email && x.pass === pass);
      if(u){
        currentUser = {name: u.name, email: u.email};
        persistAll();
        closeAuthModals();
        alert('Login berhasil. Halo, ' + currentUser.name + '!');
        updateAuthUI();
      } else {
        alert('Email atau password salah.');
      }
    }

    function logout(){
      if(confirm('Yakin ingin logout?')){
        currentUser = null;
        persistAll();
        updateAuthUI();
        alert('Anda telah logout.');
      }
    }

    function updateAuthUI(){
      // ubah header: jika login, tampilkan nama & tombol logout, jika tidak, tombol login
      const nav = document.querySelector('header nav');
      // remove any existing user-control
      const old = document.getElementById('userControl');
      if(old) old.remove();

      const container = document.createElement('div');
      container.id = 'userControl';
      container.style.display = 'flex';
      container.style.alignItems = 'center';
      container.style.gap = '8px';

      if(currentUser){
        const hello = document.createElement('div');
        hello.textContent = 'Halo, ' + currentUser.name;
        hello.style.fontWeight = '700';
        hello.style.color = 'var(--muted)';
        const logoutBtn = document.createElement('button');
        logoutBtn.className = 'cart-btn';
        logoutBtn.style.background = 'transparent';
        logoutBtn.style.color = 'var(--accent)';
        logoutBtn.style.border = '2px solid var(--pink-2)';
        logoutBtn.textContent = 'Logout';
        logoutBtn.onclick = logout;

        const chkBtn = document.createElement('button');
        chkBtn.className = 'cart-btn';
        chkBtn.style.background = 'var(--pink-3)';
        chkBtn.style.color = 'white';
        chkBtn.textContent = 'Check Pesanan';
        chkBtn.onclick = () => { scrollToSection('check-orders'); };

        container.appendChild(hello);
        container.appendChild(chkBtn);
        container.appendChild(logoutBtn);
      } else {
        const loginBtn = document.createElement('button');
        loginBtn.className = 'cart-btn';
        loginBtn.style.background = 'var(--pink-3)';
        loginBtn.style.color = 'white';
        loginBtn.textContent = 'Login / Daftar';
        loginBtn.onclick = () => { showLoginModal(); };
        container.appendChild(loginBtn);
      }
      // append to header
      document.querySelector('header').appendChild(container);
    }

    updateAuthUI(); // init

    /* ---------- CART LOGIC (baru: butuh login sebelum menambah) ---------- */
    function addToCartFromModal(){
      if(!currentUser){ alert('Silakan login terlebih dahulu sebelum menambah ke keranjang.'); showLoginModal(); return; }
      if(!currentProductFromModal) return;
      addItemToCart(currentProductFromModal.id, currentQty, false);
      closeModal();
      alert(`${currentProductFromModal.name} (${currentQty}x) ditambahkan ke keranjang.`);
    }

    // backward-compatible: if someone calls addToCart(id, price) we support both
    function addToCart(idOrName, priceOrQty){
      // if first arg is number -> interpret as productId
      if(typeof idOrName === 'number'){
        // add by productId with qty = priceOrQty (if numeric) else 1
        const prod = products.find(p => p.id === idOrName);
        const qty = (typeof priceOrQty === 'number') ? priceOrQty : 1;
        if(!currentUser){ alert('Silakan login terlebih dahulu sebelum menambah ke keranjang.'); showLoginModal(); return; }
        addItemToCart(prod.id, qty, false);
        alert(`${prod.name} (${qty}x) ditambahkan ke keranjang.`);
        return;
      }
      // else older signatures (name, price) from the earlier small demo
      if(!currentUser){ alert('Silakan login terlebih dahulu sebelum menambah ke keranjang.'); showLoginModal(); return; }
      const name = idOrName;
      const price = priceOrQty || 0;
      // push simple item
      cart.push({ id: 'ad-hoc-' + Date.now(), name, price, qty:1, box:false });
      persistAll();
      updateCartBadge();
      renderCart();
    }

    // core add by product id
    function addItemToCart(productId, qty=1, addBox=false){
      const prod = products.find(p => p.id === productId);
      if(!prod) return;
      // if same product exists (without box), increase qty
      const existing = cart.find(i => i.id === productId && i.box === addBox);
      if(existing){
        existing.qty += qty;
      } else {
        cart.push({ id: productId, name: prod.name, price: prod.price, qty: qty, box: addBox });
      }
      persistAll();
      updateCartBadge();
      renderCart();
    }

    function updateCartBadge(){
      const totalItems = cart.reduce((s,i)=> s + i.qty, 0);
      const el1 = document.getElementById('cartBadge');
      const el2 = document.getElementById('cartBadgeMobile');
      if(el1) el1.textContent = totalItems;
      if(el2) el2.textContent = totalItems;
    }

    function showCart(){
      // show cart page overlay from original layout
      document.getElementById('mainContent').style.display = 'none';
      document.getElementById('cartPage').classList.add('active');
      window.scrollTo(0,0);
      renderCart();
    }

    function renderCart(){
      const cartItems = document.getElementById('cartItems');
      const cartSummary = document.getElementById('cartSummary');
      
      if(cart.length === 0){
        cartItems.innerHTML = `
          <div class="empty-cart">
            <h3>🛒 Keranjang Kosong</h3>
            <p>Belum ada produk di keranjang Anda</p>
            <button class="btn btn-pink" onclick="showHome()">Mulai Belanja</button>
          </div>
        `;
        cartSummary.style.display = 'none';
        updateCartBadge();
        return;
      }

      cartItems.innerHTML = cart.map((item, index) => `
        <div class="cart-item">
          <img src="${(typeof item.id === 'number') ? (products.find(p=>p.id===item.id)||{}).image : ''}" alt="${item.name}">
          <div class="cart-item-info">
            <h3 style="margin:0 0 4px">${item.name}</h3>
            <div class="price">Rp ${item.price.toLocaleString('id-ID')}</div>
            ${item.box ? '<div style="font-size:13px;color:var(--muted)">+ Box Coklat</div>' : ''}
          </div>
          <div class="cart-item-actions">
            <button class="qty-btn" onclick="updateCartQty(${index}, -1)">−</button>
            <span class="qty-display">${item.qty}</span>
            <button class="qty-btn" onclick="updateCartQty(${index}, 1)">+</button>
            <button class="remove-btn" onclick="removeFromCart(${index})">Hapus</button>
          </div>
        </div>
      `).join('');

      const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
      const totalPrice = cart.reduce((sum, item) => sum + (item.price * item.qty) + (item.box ? 5000*item.qty : 0), 0);

      document.getElementById('totalItems').textContent = totalItems;
      document.getElementById('totalPrice').textContent = 'Rp ' + totalPrice.toLocaleString('id-ID');
      cartSummary.style.display = 'block';
      updateCartBadge();
    }

    function updateCartQty(index, change){
      cart[index].qty += change;
      if(cart[index].qty <= 0){
        cart.splice(index, 1);
      }
      persistAll();
      updateCartBadge();
      renderCart();
    }

    function removeFromCart(index){
      cart.splice(index, 1);
      persistAll();
      updateCartBadge();
      renderCart();
    }

    /* ---------- CHECKOUT FLOW (baru) ---------- */
    function openCheckoutModal(){
      if(!currentUser){ alert('Silakan login terlebih dahulu.'); showLoginModal(); return; }
      // prefill name & phone if available
      document.getElementById('checkoutName').value = currentUser ? currentUser.name : '';
      document.getElementById('checkoutPhone').value = '';
      document.getElementById('checkoutAddress').value = '';
      document.getElementById('checkoutRequest').value = '';
      document.getElementById('checkoutBox').checked = false;
      document.getElementById('checkoutPayment').value = 'Transfer';
      document.getElementById('checkoutModalFull').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    function closeCheckoutModal(){
      document.getElementById('checkoutModalFull').classList.remove('active');
      document.body.style.overflow = 'auto';
    }

    function submitCheckout(){
      // validate
      const name = document.getElementById('checkoutName').value.trim();
      const phone = document.getElementById('checkoutPhone').value.trim();
      const addr = document.getElementById('checkoutAddress').value.trim();
      const req = document.getElementById('checkoutRequest').value.trim();
      const boxChecked = document.getElementById('checkoutBox').checked;
      const payment = document.getElementById('checkoutPayment').value;

      if(!name || !phone || !addr){ alert('Mohon lengkapi Nama, No Telepon, dan Alamat.'); return; }
      if(cart.length === 0){ alert('Keranjang kosong.'); return; }

      const total = cart.reduce((s,i) => s + (i.price * i.qty) + (i.box ? 5000*i.qty : 0), 0) + (boxChecked ? 0 : 0);

      // create order object
      const orderId = 'ORD' + Date.now();
      const order = {
        id: orderId,
        userEmail: currentUser.email,
        userName: name,
        phone,
        address: addr,
        request: req,
        boxAdded: boxChecked,
        paymentMethod: payment,
        items: JSON.parse(JSON.stringify(cart)),
        total,
        createdAt: new Date().toISOString(),
        status: 'Menunggu Pembayaran' // initial status
      };

      orders.push(order);
      // clear cart
      cart = [];
      persistAll();
      updateCartBadge();
      renderCart();
      closeCheckoutModal();
      alert('Pesanan dibuat: ' + orderId + '. Silakan lakukan pembayaran via ' + payment + '. Status awal: Menunggu Pembayaran.');
      renderOrders();
      showHome();
      scrollToSection('check-orders');
    }

    /* ---------- ORDERS (Check Pesanan) ---------- */
    function renderOrders(){
      const container = document.getElementById('ordersContainer');
      container.innerHTML = '';
      // show only current user's orders (or all if not logged)
      const list = currentUser ? orders.filter(o => o.userEmail === currentUser.email) : orders;
      if(list.length === 0){
        container.innerHTML = `<div style="padding:20px;background:var(--glass);border-radius:12px;text-align:center;color:var(--muted)">Belum ada pesanan.</div>`;
        return;
      }
      list.forEach(o => {
        const itemsHtml = o.items.map(it => `${it.name} (${it.qty}x)`).join(', ');
        const card = document.createElement('div');
        card.className = 'order-card';
        card.innerHTML = `
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div>
              <strong>${o.id}</strong><div style="font-size:13px;color:var(--muted)">${new Date(o.createdAt).toLocaleString()}</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:700;color:var(--pink-3)">Rp ${o.total.toLocaleString('id-ID')}</div>
              <div style="font-size:13px;color:var(--muted)">${o.paymentMethod}</div>
            </div>
          </div>
          <div style="margin-bottom:8px"><b>Penerima:</b> ${o.userName} — ${o.phone}</div>
          <div style="margin-bottom:8px"><b>Alamat:</b> ${o.address}</div>
          <div style="margin-bottom:8px"><b>Request:</b> ${o.request || '-'}</div>
          <div style="margin-bottom:8px"><b>Items:</b> ${itemsHtml}</div>
          <div style="margin-bottom:8px"><b>Status:</b> <span id="status-${o.id}">${o.status}</span></div>
          <div class="order-actions">
            ${o.status !== 'Selesai' ? `<button class="btn btn-outline" onclick="simulatePayment('${o.id}')">Saya Sudah Bayar</button>` : ''}
            ${o.status !== 'Selesai' ? `<button class="btn btn-pink" onclick="advanceOrderStatus('${o.id}')">Update Status (Sim)</button>` : ''}
            <button class="btn-ghost" onclick="viewOrderInvoice('${o.id}')">Lihat Detail</button>
          </div>
        `;
        container.appendChild(card);
      });
    }

    function viewOrderInvoice(orderId){
      const o = orders.find(x => x.id === orderId);
      if(!o) return alert('Order tidak ditemukan');
      let itemsHtml = o.items.map(it => `<li>${it.name} (${it.qty}x) - Rp ${it.price.toLocaleString('id-ID')}</li>`).join('');
      const s = `
        Pesanan: ${o.id}\n
        Nama: ${o.userName}\n
        Alamat: ${o.address}\n
        Telepon: ${o.phone}\n
        Request: ${o.request || '-'}\n
        Metode: ${o.paymentMethod}\n
        Status: ${o.status}\n
        Items:\n${o.items.map(it=>` - ${it.name} (${it.qty}x)`).join('\n')}
      `;
      alert(s);
    }

    // simulate buyer confirming payment -> sets "Menunggu Konfirmasi" or "Diproses"
    function simulatePayment(orderId){
      const o = orders.find(x => x.id === orderId);
      if(!o) return alert('Order tidak ditemukan');
      if(o.status === 'Menunggu Pembayaran'){
        o.status = 'Menunggu Konfirmasi';
        persistAll();
        renderOrders();
        alert('Pembayaran dicatat. Status berubah jadi "Menunggu Konfirmasi". (Simulasi)');
      } else {
        alert('Tidak bisa membayar pada status ini.');
      }
    }

    // simulate admin/process update status (Menunggu Pembayaran -> Diproses -> Dikirim -> Selesai)
    function advanceOrderStatus(orderId){
      const o = orders.find(x => x.id === orderId);
      if(!o) return alert('Order tidak ditemukan');
      const steps = ['Menunggu Pembayaran','Menunggu Konfirmasi','Diproses','Dikirim','Selesai'];
      const idx = steps.indexOf(o.status);
      if(idx === -1 || idx === steps.length - 1){
        alert('Tidak ada status selanjutnya.');
        return;
      }
      o.status = steps[idx + 1];
      persistAll();
      renderOrders();
      alert('Status diperbarui: ' + o.status);
    }

    /* ---------- UTILITIES ---------- */
    function persistAllAndRender(){
      persistAll();
      renderOrders();
      renderCart();
      updateCartBadge();
    }

    // small helper: when users click cart header from top-right
    // already implemented as showCart()

    // Expose some functions to global scope for onclick from HTML
    window.showLogin = () => { showLoginModal(); };
    window.showCart = showCart;
    window.showHome = showHome;
    window.scrollToSection = scrollToSection;
    window.openQuickView = openQuickView;
    window.addToCart = addToCart; // maintain signature for older quick demo
    window.filterMenu = filterMenu;
    window.showRandomMessage = showRandomMessage;
    window.updateCartQty = updateCartQty;
    window.removeFromCart = removeFromCart;
    window.checkout = openCheckoutModal;
    window.closeCheckoutModal = closeCheckoutModal;
    window.submitCheckout = submitCheckout;
    window.renderOrders = renderOrders;
    window.advanceOrderStatus = advanceOrderStatus;
    window.simulatePayment = simulatePayment;
    window.viewOrderInvoice = viewOrderInvoice;
    window.logout = logout;

    // ensure persist on unload
    window.addEventListener('beforeunload', persistAll);

  </script>
</body>
</html>
